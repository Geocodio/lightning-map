{"version":3,"sources":["webpack://LightningMaps/webpack/universalModuleDefinition","webpack://LightningMaps/webpack/bootstrap","webpack://LightningMaps/./node_modules/robust-orientation/orientation.js","webpack://LightningMaps/./node_modules/robust-point-in-polygon/robust-pnp.js","webpack://LightningMaps/./node_modules/robust-scale/robust-scale.js","webpack://LightningMaps/./node_modules/robust-subtract/robust-diff.js","webpack://LightningMaps/./node_modules/robust-sum/robust-sum.js","webpack://LightningMaps/./node_modules/topojson-client/index.js","webpack://LightningMaps/./node_modules/topojson-client/src/bbox.js","webpack://LightningMaps/./node_modules/topojson-client/src/bisect.js","webpack://LightningMaps/./node_modules/topojson-client/src/feature.js","webpack://LightningMaps/./node_modules/topojson-client/src/identity.js","webpack://LightningMaps/./node_modules/topojson-client/src/merge.js","webpack://LightningMaps/./node_modules/topojson-client/src/mesh.js","webpack://LightningMaps/./node_modules/topojson-client/src/neighbors.js","webpack://LightningMaps/./node_modules/topojson-client/src/quantize.js","webpack://LightningMaps/./node_modules/topojson-client/src/reverse.js","webpack://LightningMaps/./node_modules/topojson-client/src/stitch.js","webpack://LightningMaps/./node_modules/topojson-client/src/transform.js","webpack://LightningMaps/./node_modules/topojson-client/src/untransform.js","webpack://LightningMaps/./node_modules/two-product/two-product.js","webpack://LightningMaps/./node_modules/two-sum/two-sum.js","webpack://LightningMaps/./src/Map.js","webpack://LightningMaps/./src/MapState.js","webpack://LightningMaps/./src/Marker.js","webpack://LightningMaps/./src/MarkerRenderer.js","webpack://LightningMaps/./src/Polygon.js","webpack://LightningMaps/./src/Tile.js","webpack://LightningMaps/./src/TileConversion.js","webpack://LightningMaps/./src/TileLayer.js","webpack://LightningMaps/./src/defaultOptions.js","webpack://LightningMaps/./src/index.js"],"names":["Map","canvas","options","getContext","Error","context","Object","assign","defaultMapOptions","initializeState","attachEvents","lastDrawState","onMarkerClicked","onMarkerHover","onPolygonClicked","onPolygonHover","draw","bind","window","requestAnimationFrame","state","canvasDimensions","width","height","tiles","moveOffset","targetMoveOffset","targetMoveOffsetIsCoord","moveAnimationStart","dragStartPosition","lastZoomEventActionTime","startZoom","zoom","targetZoom","zoomAnimationStart","scale","lastMouseMoveEvent","mouseVelocities","markerRenderer","MarkerRenderer","polygons","tileLayers","TileLayer","mousePosition","x","y","forceRedraw","zoomValueIsValid","isReadyForZoomEvent","Math","round","push","performance","now","coord","Array","isArray","length","map","parseFloat","animated","TileConversion","pixelToLatLon","center","tileSize","milliSecondsSinceLastEvent","debounceIntervalMs","position1","position2","time1","time2","addEventListener","event","preventDefault","deltaY","setZoom","updateMousePosition","handleMouseEventInteraction","canvasCenter","getCanvasCenter","setTargetMoveOffset","dragDistanceBelowThreshold","abs","timingThreshold","throwTimingThresholdMs","thresholdsToConsider","filter","threshold","velocitySum","reduce","accumulator","velocity","averageVelocity","throwVelocityThreshold","multiplier","panAccelerationMultiplier","min","maxPanAcceleration","updateCenter","vx","calculateVelocity","vy","sqrt","rect","getBoundingClientRect","clientX","left","clientY","top","time","targetMoveOffsetChanged","timestamp","progress","max","percentage","easeOutQuad","animationDurationMs","latLonToPixel","targetHasBeenReached","latLon","differenceFromTarget","newZoomDiff","remainingTime","roundedZoom","diff","pow","shift","tilesZoomLevel","allTiles","values","maxTilesToKeep","tileExpirationCutOff","Date","getTime","tilesToConsider","tile","lastRequested","sort","a","b","tilesToDeleteCount","splice","forEach","src","tileId","MapState","drawState","JSON","stringify","updateMoveOffset","updateZoom","tileLayer","calculateGrid","garbageCollect","shouldRedraw","drawTiles","mapState","snapshotMapState","renderPolygons","renderMarkers","renderControls","renderAttribution","nw","se","render","getMapBounds","polygon","enablePolygonInteractivity","isCurrentlyDraggingMap","handleMouseOver","name","controlObjects","getControlObjects","item","isMouseOverObject","bounds","markers","getMarkersBounds","controlObject","label","marker","controlsOrMarkersIsHover","polygonIsHover","eventHandler","style","cursor","margin","size","renderControl","radius","fillStyle","roundedRectangle","font","textAlign","textBaseline","fillText","textBounds","measureText","attribution","beginPath","moveTo","lineTo","quadraticCurveTo","closePath","fill","addMarker","_center","_zoom","_targetZoom","_tileSize","_canvasDimensions","_canvasCenter","_moveOffset","Marker","coords","_coords","_options","defaultMarkerOptions","position","renderFunction","type","renderMarker","renderCircle","renderDonut","renderImage","color","strokeStyle","lineWidth","save","arc","PI","enableStroke","stroke","restore","transform","bezierCurveTo","image","offset","drawImage","strokeMargin","_markers","offscreenCanvas","originZoom","floor","ceil","mapBounds","determineOriginZoom","zoomDiff","shouldReRender","renderOffScreenCanvas","canvasDrawPosition","canvasDrawDimensions","mapCenterChanged","renderedMapCenter","mapZoomChanged","renderedZoomLevel","createOffscreenCanvas","visibleMarkers","getVisibleMarkers","document","createElement","markerSize","markerOffset","Polygon","json","objectName","hoverOptions","defaultPolygonOptions","_hoverOptions","defaultPolygonHoverOptions","globalIndex","prepareGlobalDataObject","keys","objects","join","geometry","feature","lightningMapsPolygons","index","projectedGeometry","currentlyZooming","centerOffset","calculateCenterOffset","point","isHover","list","classifyPoint","applyContextStyles","enableFill","lon2tile","lat2tile","features","projectGeometry","calculatePolygonExtends","imagePosition","polygonExtends","minX","minY","imageRect","right","bottom","renderOffscreenCanvas","imageDrawPosition","scaledWidth","polygonDimensions","scaledHeight","clipRect","maxX","maxY","mapGeometry","offscreenContext","pointsInClipRect","setLineDash","lineDash","lineJoin","pointCallback","coordinates","projectPoint","Tile","_x","_y","lon","rounded","lat","log","tan","cos","z","n","atan","exp","ne","tile2lat","tile2lon","sw","pixel","pointDiff","tileX","tileY","tileCenterX","tileCenterY","shouldBeDeleted","grid","gridHash","relativeTileOffset","loadedPercentage","canvasSize","tilesCount","tileAreaMultiplier","centerY","centerX","gridNeedsToBeUpdated","horizontalTiles","getTilesCount","verticalTiles","centerYRounded","centerXRounded","startX","startY","isValid","ensureTileAsset","id","tileUrl","source","Image","loaded","onload","canvasWidth","canvasHeight","fillRect","horizontalOverflow","verticalOverflow","drawGenericBackground","err","debug","strokeRect","increment","lineX","lineY","totalTiles","loadedTiles","cachedTile"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;AClFY;;AAEZ,iBAAiB,mBAAO,CAAC,8DAAa;AACtC,gBAAgB,mBAAO,CAAC,2DAAY;AACpC,kBAAkB,mBAAO,CAAC,iEAAc;AACxC,qBAAqB,mBAAO,CAAC,sEAAiB;;AAE9C;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc,YAAY;AAC1B;AACA,oBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc,KAAK;AACnB;AACA,gBAAgB,KAAK;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAc,KAAK;AACnB;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,+CAA+C;AACzG,uBAAuB;AACvB;AACA;AACA;;AAEA;AACA;;AAEA;AACA,2BAA2B,WAAW;AACtC,2BAA2B,WAAW;AACtC,+B;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,eAAe;AAC7B;AACA;AACA;AACA;AACA,gDAAgD,yBAAyB,uBAAuB;AAChG;AACA,cAAc,eAAe;AAC7B,2EAA2E;AAC3E;AACA,cAAc,kCAAkC,YAAY,mBAAmB,KAAK,mBAAmB,gBAAgB;AACvH;;AAEA;AACA;AACA,cAAc,eAAe;AAC7B;AACA;AACA;;AAEA,yB;;;;;;;;;;;AC7LA;;AAEA,aAAa,mBAAO,CAAC,4EAAoB;;AAEzC;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,OAAO;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;ACnGY;;AAEZ,iBAAiB,mBAAO,CAAC,8DAAa;AACtC,aAAa,mBAAO,CAAC,kDAAS;;AAE9B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,KAAK;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;ACjDY;;AAEZ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,K;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;AC3JY;;AAEZ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,K;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;AC3JA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2C;AACM;AACI;AACG;AACH;AACF;AACE;AACI;;;;;;;;;;;;;ACPzD;AAAA;AAAoC;;AAErB;AACf,UAAU,0DAAS;AACnB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,oEAAoE;AACpE,6CAA6C;AAC7C,0DAA0D;AAC1D;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA,CAAC;;;;;;;;;;;;;ACtCD;AAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;ACRD;AAAA;AAAA;AAAA;AAAA;AAAgC;AACI;;AAErB;AACf;AACA,SAAS,mEAAmE,6BAA6B,EAAE;AAC3G;AACA,CAAC;;AAEM;AACP;AACA;AACA,4CAA4C;AAC5C;AACA,uCAAuC;AACvC,wBAAwB;AACxB,SAAS;AACT;;AAEO;AACP,uBAAuB,0DAAS;AAChC;;AAEA;AACA;AACA,2DAA2D,OAAO;AAClE;AACA;AACA,eAAe,wDAAO;AACtB;;AAEA;AACA;AACA;;AAEA;AACA;AACA,oCAAoC,OAAO;AAC3C,kDAAkD;AAClD;AACA;;AAEA;AACA;AACA,qDAAqD;AACrD;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,yCAAyC;AACzC,uDAAuD;AACvD,gEAAgE;AAChE,oDAAoD;AACpD,6DAA6D;AAC7D,oDAAoD;AACpD,6DAA6D;AAC7D;AACA;AACA,YAAY;AACZ;;AAEA;AACA;;;;;;;;;;;;;ACpEA;AAAe;AACf;AACA,CAAC;;;;;;;;;;;;;ACFD;AAAA;AAAA;AAAA;AAAiC;AACH;;AAE9B;AACA;AACA;AACA,wBAAwB;AACxB;;AAEe;AACf,SAAS,uDAAM;AACf,CAAC;;AAEM;AACP,wBAAwB;AACxB;AACA;;AAEA;;AAEA;AACA;AACA,gEAAgE;AAChE,sCAAsC;AACtC,mDAAmD;AACnD;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;;AAEA;AACA,0BAA0B,uDAAM,YAAY,8BAA8B;AAC1E;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW;AACX,SAAS;AACT;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT,OAAO;;AAEP;AACA,aAAa,uDAAM;;AAEnB;AACA;AACA;AACA;AACA,iDAAiD,OAAO;AACxD;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;;;;;;;;;;;;;ACpGA;AAAA;AAAA;AAAA;AAAiC;AACH;;AAEf;AACf,SAAS,uDAAM;AACf,CAAC;;AAEM;AACP;AACA;AACA,8DAA8D,OAAO;AACrE,UAAU,+BAA+B,uDAAM;AAC/C;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,kDAAkD,cAAc;AAChE;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,gEAAgE;AAChE,0CAA0C;AAC1C,+DAA+D;AAC/D,4CAA4C;AAC5C;AACA;;AAEA;;AAEA;AACA,yBAAyB,uBAAuB;AAChD,yBAAyB,0EAA0E,EAAE;;AAErG;AACA;;;;;;;;;;;;;ACpDA;AAAA;AAA8B;;AAEf;AACf,uBAAuB;AACvB,0CAA0C,WAAW,EAAE;;AAEvD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA,gCAAgC,cAAc,EAAE;AAChD;;AAEA;AACA,2EAA2E,gBAAgB,EAAE;AAC7F;AACA;;AAEA;AACA;AACA;AACA;AACA,qCAAqC,6BAA6B,iBAAiB,EAAE,EAAE;AACvF;;AAEA;;AAEA;AACA,kEAAkE,OAAO;AACzE,yBAAyB,OAAO;AAChC;AACA,oCAAoC,uDAAM;AAC1C,oCAAoC,uDAAM;AAC1C;AACA;AACA;;AAEA;AACA,CAAC;;;;;;;;;;;;;AC5CD;AAAA;AAAA;AAA0B;AACc;;AAEzB;AACf;;AAEA;AACA;AACA,2BAA2B,qDAAI;AAC/B;AACA,iBAAiB;AACjB,GAAG;AACH;AACA;;AAEA,UAAU,4DAAW;;AAErB;AACA;AACA;;AAEA;AACA;AACA;AACA,2CAA2C,gFAAgF;AAC3H,8BAA8B,8DAA8D;AAC5F,mCAAmC,uEAAuE;AAC1G;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iEAAiE;AACjE;AACA,yEAAyE;AACzE,sCAAsC;AACtC;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;ACrDD;AAAe;AACf;AACA;AACA,CAAC;;;;;;;;;;;;;ACHD;AAAe;AACf,uBAAuB;AACvB,0BAA0B;AAC1B,wBAAwB;AACxB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,mEAAmE,gCAAgC,EAAE;AACrG;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,kCAAkC,EAAE;AACjE;AACA;AACA;;AAEA;AACA;AACA,4BAA4B,wDAAwD,EAAE;;AAEtF;AACA,CAAC;;;;;;;;;;;;;ACxED;AAAA;AAAkC;;AAEnB;AACf,gCAAgC,iDAAQ;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;AClBD;AAAA;AAAkC;;AAEnB;AACf,gCAAgC,iDAAQ;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;ACtBW;;AAEZ;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,C;;;;;;;;;;;;AChCY;;AAEZ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;;;;;;;;;;;;;;AChBA;AACA;AACA;AACA;AACA;;IAEqBA,G;;;AAEnB,eAAYC,MAAZ,EAAoBC,OAApB,EAA6B;AAAA;;AAC3B,QAAI,CAACD,MAAD,IAAW,CAACA,MAAM,CAACE,UAAvB,EAAmC;AACjC,YAAM,IAAIC,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","file":"LightningMaps.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"LightningMaps\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"LightningMaps\"] = factory();\n\telse\n\t\troot[\"LightningMaps\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","\"use strict\"\n\nvar twoProduct = require(\"two-product\")\nvar robustSum = require(\"robust-sum\")\nvar robustScale = require(\"robust-scale\")\nvar robustSubtract = require(\"robust-subtract\")\n\nvar NUM_EXPAND = 5\n\nvar EPSILON     = 1.1102230246251565e-16\nvar ERRBOUND3   = (3.0 + 16.0 * EPSILON) * EPSILON\nvar ERRBOUND4   = (7.0 + 56.0 * EPSILON) * EPSILON\n\nfunction cofactor(m, c) {\n  var result = new Array(m.length-1)\n  for(var i=1; i<m.length; ++i) {\n    var r = result[i-1] = new Array(m.length-1)\n    for(var j=0,k=0; j<m.length; ++j) {\n      if(j === c) {\n        continue\n      }\n      r[k++] = m[i][j]\n    }\n  }\n  return result\n}\n\nfunction matrix(n) {\n  var result = new Array(n)\n  for(var i=0; i<n; ++i) {\n    result[i] = new Array(n)\n    for(var j=0; j<n; ++j) {\n      result[i][j] = [\"m\", j, \"[\", (n-i-1), \"]\"].join(\"\")\n    }\n  }\n  return result\n}\n\nfunction sign(n) {\n  if(n & 1) {\n    return \"-\"\n  }\n  return \"\"\n}\n\nfunction generateSum(expr) {\n  if(expr.length === 1) {\n    return expr[0]\n  } else if(expr.length === 2) {\n    return [\"sum(\", expr[0], \",\", expr[1], \")\"].join(\"\")\n  } else {\n    var m = expr.length>>1\n    return [\"sum(\", generateSum(expr.slice(0, m)), \",\", generateSum(expr.slice(m)), \")\"].join(\"\")\n  }\n}\n\nfunction determinant(m) {\n  if(m.length === 2) {\n    return [[\"sum(prod(\", m[0][0], \",\", m[1][1], \"),prod(-\", m[0][1], \",\", m[1][0], \"))\"].join(\"\")]\n  } else {\n    var expr = []\n    for(var i=0; i<m.length; ++i) {\n      expr.push([\"scale(\", generateSum(determinant(cofactor(m, i))), \",\", sign(i), m[0][i], \")\"].join(\"\"))\n    }\n    return expr\n  }\n}\n\nfunction orientation(n) {\n  var pos = []\n  var neg = []\n  var m = matrix(n)\n  var args = []\n  for(var i=0; i<n; ++i) {\n    if((i&1)===0) {\n      pos.push.apply(pos, determinant(cofactor(m, i)))\n    } else {\n      neg.push.apply(neg, determinant(cofactor(m, i)))\n    }\n    args.push(\"m\" + i)\n  }\n  var posExpr = generateSum(pos)\n  var negExpr = generateSum(neg)\n  var funcName = \"orientation\" + n + \"Exact\"\n  var code = [\"function \", funcName, \"(\", args.join(), \"){var p=\", posExpr, \",n=\", negExpr, \",d=sub(p,n);\\\nreturn d[d.length-1];};return \", funcName].join(\"\")\n  var proc = new Function(\"sum\", \"prod\", \"scale\", \"sub\", code)\n  return proc(robustSum, twoProduct, robustScale, robustSubtract)\n}\n\nvar orientation3Exact = orientation(3)\nvar orientation4Exact = orientation(4)\n\nvar CACHED = [\n  function orientation0() { return 0 },\n  function orientation1() { return 0 },\n  function orientation2(a, b) { \n    return b[0] - a[0]\n  },\n  function orientation3(a, b, c) {\n    var l = (a[1] - c[1]) * (b[0] - c[0])\n    var r = (a[0] - c[0]) * (b[1] - c[1])\n    var det = l - r\n    var s\n    if(l > 0) {\n      if(r <= 0) {\n        return det\n      } else {\n        s = l + r\n      }\n    } else if(l < 0) {\n      if(r >= 0) {\n        return det\n      } else {\n        s = -(l + r)\n      }\n    } else {\n      return det\n    }\n    var tol = ERRBOUND3 * s\n    if(det >= tol || det <= -tol) {\n      return det\n    }\n    return orientation3Exact(a, b, c)\n  },\n  function orientation4(a,b,c,d) {\n    var adx = a[0] - d[0]\n    var bdx = b[0] - d[0]\n    var cdx = c[0] - d[0]\n    var ady = a[1] - d[1]\n    var bdy = b[1] - d[1]\n    var cdy = c[1] - d[1]\n    var adz = a[2] - d[2]\n    var bdz = b[2] - d[2]\n    var cdz = c[2] - d[2]\n    var bdxcdy = bdx * cdy\n    var cdxbdy = cdx * bdy\n    var cdxady = cdx * ady\n    var adxcdy = adx * cdy\n    var adxbdy = adx * bdy\n    var bdxady = bdx * ady\n    var det = adz * (bdxcdy - cdxbdy) \n            + bdz * (cdxady - adxcdy)\n            + cdz * (adxbdy - bdxady)\n    var permanent = (Math.abs(bdxcdy) + Math.abs(cdxbdy)) * Math.abs(adz)\n                  + (Math.abs(cdxady) + Math.abs(adxcdy)) * Math.abs(bdz)\n                  + (Math.abs(adxbdy) + Math.abs(bdxady)) * Math.abs(cdz)\n    var tol = ERRBOUND4 * permanent\n    if ((det > tol) || (-det > tol)) {\n      return det\n    }\n    return orientation4Exact(a,b,c,d)\n  }\n]\n\nfunction slowOrient(args) {\n  var proc = CACHED[args.length]\n  if(!proc) {\n    proc = CACHED[args.length] = orientation(args.length)\n  }\n  return proc.apply(undefined, args)\n}\n\nfunction generateOrientationProc() {\n  while(CACHED.length <= NUM_EXPAND) {\n    CACHED.push(orientation(CACHED.length))\n  }\n  var args = []\n  var procArgs = [\"slow\"]\n  for(var i=0; i<=NUM_EXPAND; ++i) {\n    args.push(\"a\" + i)\n    procArgs.push(\"o\" + i)\n  }\n  var code = [\n    \"function getOrientation(\", args.join(), \"){switch(arguments.length){case 0:case 1:return 0;\"\n  ]\n  for(var i=2; i<=NUM_EXPAND; ++i) {\n    code.push(\"case \", i, \":return o\", i, \"(\", args.slice(0, i).join(), \");\")\n  }\n  code.push(\"}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation\")\n  procArgs.push(code.join(\"\"))\n\n  var proc = Function.apply(undefined, procArgs)\n  module.exports = proc.apply(undefined, [slowOrient].concat(CACHED))\n  for(var i=0; i<=NUM_EXPAND; ++i) {\n    module.exports[i] = CACHED[i]\n  }\n}\n\ngenerateOrientationProc()","module.exports = robustPointInPolygon\n\nvar orient = require('robust-orientation')\n\nfunction robustPointInPolygon(vs, point) {\n  var x = point[0]\n  var y = point[1]\n  var n = vs.length\n  var inside = 1\n  var lim = n\n  for(var i = 0, j = n-1; i<lim; j=i++) {\n    var a = vs[i]\n    var b = vs[j]\n    var yi = a[1]\n    var yj = b[1]\n    if(yj < yi) {\n      if(yj < y && y < yi) {\n        var s = orient(a, b, point)\n        if(s === 0) {\n          return 0\n        } else {\n          inside ^= (0 < s)|0\n        }\n      } else if(y === yi) {\n        var c = vs[(i+1)%n]\n        var yk = c[1]\n        if(yi < yk) {\n          var s = orient(a, b, point)\n          if(s === 0) {\n            return 0\n          } else {\n            inside ^= (0 < s)|0\n          }\n        }\n      }\n    } else if(yi < yj) {\n      if(yi < y && y < yj) {\n        var s = orient(a, b, point)\n        if(s === 0) {\n          return 0\n        } else {\n          inside ^= (s < 0)|0\n        }\n      } else if(y === yi) {\n        var c = vs[(i+1)%n]\n        var yk = c[1]\n        if(yk < yi) {\n          var s = orient(a, b, point)\n          if(s === 0) {\n            return 0\n          } else {\n            inside ^= (s < 0)|0\n          }\n        }\n      }\n    } else if(y === yi) {\n      var x0 = Math.min(a[0], b[0])\n      var x1 = Math.max(a[0], b[0])\n      if(i === 0) {\n        while(j>0) {\n          var k = (j+n-1)%n\n          var p = vs[k]\n          if(p[1] !== y) {\n            break\n          }\n          var px = p[0]\n          x0 = Math.min(x0, px)\n          x1 = Math.max(x1, px)\n          j = k\n        }\n        if(j === 0) {\n          if(x0 <= x && x <= x1) {\n            return 0\n          }\n          return 1 \n        }\n        lim = j+1\n      }\n      var y0 = vs[(j+n-1)%n][1]\n      while(i+1<lim) {\n        var p = vs[i+1]\n        if(p[1] !== y) {\n          break\n        }\n        var px = p[0]\n        x0 = Math.min(x0, px)\n        x1 = Math.max(x1, px)\n        i += 1\n      }\n      if(x0 <= x && x <= x1) {\n        return 0\n      }\n      var y1 = vs[(i+1)%n][1]\n      if(x < x0 && (y0 < y !== y1 < y)) {\n        inside ^= 1\n      }\n    }\n  }\n  return 2 * inside - 1\n}","\"use strict\"\n\nvar twoProduct = require(\"two-product\")\nvar twoSum = require(\"two-sum\")\n\nmodule.exports = scaleLinearExpansion\n\nfunction scaleLinearExpansion(e, scale) {\n  var n = e.length\n  if(n === 1) {\n    var ts = twoProduct(e[0], scale)\n    if(ts[0]) {\n      return ts\n    }\n    return [ ts[1] ]\n  }\n  var g = new Array(2 * n)\n  var q = [0.1, 0.1]\n  var t = [0.1, 0.1]\n  var count = 0\n  twoProduct(e[0], scale, q)\n  if(q[0]) {\n    g[count++] = q[0]\n  }\n  for(var i=1; i<n; ++i) {\n    twoProduct(e[i], scale, t)\n    var pq = q[1]\n    twoSum(pq, t[0], q)\n    if(q[0]) {\n      g[count++] = q[0]\n    }\n    var a = t[1]\n    var b = q[1]\n    var x = a + b\n    var bv = x - a\n    var y = b - bv\n    q[1] = x\n    if(y) {\n      g[count++] = y\n    }\n  }\n  if(q[1]) {\n    g[count++] = q[1]\n  }\n  if(count === 0) {\n    g[count++] = 0.0\n  }\n  g.length = count\n  return g\n}","\"use strict\"\n\nmodule.exports = robustSubtract\n\n//Easy case: Add two scalars\nfunction scalarScalar(a, b) {\n  var x = a + b\n  var bv = x - a\n  var av = x - bv\n  var br = b - bv\n  var ar = a - av\n  var y = ar + br\n  if(y) {\n    return [y, x]\n  }\n  return [x]\n}\n\nfunction robustSubtract(e, f) {\n  var ne = e.length|0\n  var nf = f.length|0\n  if(ne === 1 && nf === 1) {\n    return scalarScalar(e[0], -f[0])\n  }\n  var n = ne + nf\n  var g = new Array(n)\n  var count = 0\n  var eptr = 0\n  var fptr = 0\n  var abs = Math.abs\n  var ei = e[eptr]\n  var ea = abs(ei)\n  var fi = -f[fptr]\n  var fa = abs(fi)\n  var a, b\n  if(ea < fa) {\n    b = ei\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n      ea = abs(ei)\n    }\n  } else {\n    b = fi\n    fptr += 1\n    if(fptr < nf) {\n      fi = -f[fptr]\n      fa = abs(fi)\n    }\n  }\n  if((eptr < ne && ea < fa) || (fptr >= nf)) {\n    a = ei\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n      ea = abs(ei)\n    }\n  } else {\n    a = fi\n    fptr += 1\n    if(fptr < nf) {\n      fi = -f[fptr]\n      fa = abs(fi)\n    }\n  }\n  var x = a + b\n  var bv = x - a\n  var y = b - bv\n  var q0 = y\n  var q1 = x\n  var _x, _bv, _av, _br, _ar\n  while(eptr < ne && fptr < nf) {\n    if(ea < fa) {\n      a = ei\n      eptr += 1\n      if(eptr < ne) {\n        ei = e[eptr]\n        ea = abs(ei)\n      }\n    } else {\n      a = fi\n      fptr += 1\n      if(fptr < nf) {\n        fi = -f[fptr]\n        fa = abs(fi)\n      }\n    }\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    }\n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n  }\n  while(eptr < ne) {\n    a = ei\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    }\n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n    }\n  }\n  while(fptr < nf) {\n    a = fi\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    } \n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n    fptr += 1\n    if(fptr < nf) {\n      fi = -f[fptr]\n    }\n  }\n  if(q0) {\n    g[count++] = q0\n  }\n  if(q1) {\n    g[count++] = q1\n  }\n  if(!count) {\n    g[count++] = 0.0  \n  }\n  g.length = count\n  return g\n}","\"use strict\"\n\nmodule.exports = linearExpansionSum\n\n//Easy case: Add two scalars\nfunction scalarScalar(a, b) {\n  var x = a + b\n  var bv = x - a\n  var av = x - bv\n  var br = b - bv\n  var ar = a - av\n  var y = ar + br\n  if(y) {\n    return [y, x]\n  }\n  return [x]\n}\n\nfunction linearExpansionSum(e, f) {\n  var ne = e.length|0\n  var nf = f.length|0\n  if(ne === 1 && nf === 1) {\n    return scalarScalar(e[0], f[0])\n  }\n  var n = ne + nf\n  var g = new Array(n)\n  var count = 0\n  var eptr = 0\n  var fptr = 0\n  var abs = Math.abs\n  var ei = e[eptr]\n  var ea = abs(ei)\n  var fi = f[fptr]\n  var fa = abs(fi)\n  var a, b\n  if(ea < fa) {\n    b = ei\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n      ea = abs(ei)\n    }\n  } else {\n    b = fi\n    fptr += 1\n    if(fptr < nf) {\n      fi = f[fptr]\n      fa = abs(fi)\n    }\n  }\n  if((eptr < ne && ea < fa) || (fptr >= nf)) {\n    a = ei\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n      ea = abs(ei)\n    }\n  } else {\n    a = fi\n    fptr += 1\n    if(fptr < nf) {\n      fi = f[fptr]\n      fa = abs(fi)\n    }\n  }\n  var x = a + b\n  var bv = x - a\n  var y = b - bv\n  var q0 = y\n  var q1 = x\n  var _x, _bv, _av, _br, _ar\n  while(eptr < ne && fptr < nf) {\n    if(ea < fa) {\n      a = ei\n      eptr += 1\n      if(eptr < ne) {\n        ei = e[eptr]\n        ea = abs(ei)\n      }\n    } else {\n      a = fi\n      fptr += 1\n      if(fptr < nf) {\n        fi = f[fptr]\n        fa = abs(fi)\n      }\n    }\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    }\n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n  }\n  while(eptr < ne) {\n    a = ei\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    }\n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n    }\n  }\n  while(fptr < nf) {\n    a = fi\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    } \n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n    fptr += 1\n    if(fptr < nf) {\n      fi = f[fptr]\n    }\n  }\n  if(q0) {\n    g[count++] = q0\n  }\n  if(q1) {\n    g[count++] = q1\n  }\n  if(!count) {\n    g[count++] = 0.0  \n  }\n  g.length = count\n  return g\n}","export {default as bbox} from \"./src/bbox\";\nexport {default as feature} from \"./src/feature\";\nexport {default as mesh, meshArcs} from \"./src/mesh\";\nexport {default as merge, mergeArcs} from \"./src/merge\";\nexport {default as neighbors} from \"./src/neighbors\";\nexport {default as quantize} from \"./src/quantize\";\nexport {default as transform} from \"./src/transform\";\nexport {default as untransform} from \"./src/untransform\";\n","import transform from \"./transform\";\n\nexport default function(topology) {\n  var t = transform(topology.transform), key,\n      x0 = Infinity, y0 = x0, x1 = -x0, y1 = -x0;\n\n  function bboxPoint(p) {\n    p = t(p);\n    if (p[0] < x0) x0 = p[0];\n    if (p[0] > x1) x1 = p[0];\n    if (p[1] < y0) y0 = p[1];\n    if (p[1] > y1) y1 = p[1];\n  }\n\n  function bboxGeometry(o) {\n    switch (o.type) {\n      case \"GeometryCollection\": o.geometries.forEach(bboxGeometry); break;\n      case \"Point\": bboxPoint(o.coordinates); break;\n      case \"MultiPoint\": o.coordinates.forEach(bboxPoint); break;\n    }\n  }\n\n  topology.arcs.forEach(function(arc) {\n    var i = -1, n = arc.length, p;\n    while (++i < n) {\n      p = t(arc[i], i);\n      if (p[0] < x0) x0 = p[0];\n      if (p[0] > x1) x1 = p[0];\n      if (p[1] < y0) y0 = p[1];\n      if (p[1] > y1) y1 = p[1];\n    }\n  });\n\n  for (key in topology.objects) {\n    bboxGeometry(topology.objects[key]);\n  }\n\n  return [x0, y0, x1, y1];\n}\n","export default function(a, x) {\n  var lo = 0, hi = a.length;\n  while (lo < hi) {\n    var mid = lo + hi >>> 1;\n    if (a[mid] < x) lo = mid + 1;\n    else hi = mid;\n  }\n  return lo;\n}\n","import reverse from \"./reverse\";\nimport transform from \"./transform\";\n\nexport default function(topology, o) {\n  return o.type === \"GeometryCollection\"\n      ? {type: \"FeatureCollection\", features: o.geometries.map(function(o) { return feature(topology, o); })}\n      : feature(topology, o);\n}\n\nexport function feature(topology, o) {\n  var id = o.id,\n      bbox = o.bbox,\n      properties = o.properties == null ? {} : o.properties,\n      geometry = object(topology, o);\n  return id == null && bbox == null ? {type: \"Feature\", properties: properties, geometry: geometry}\n      : bbox == null ? {type: \"Feature\", id: id, properties: properties, geometry: geometry}\n      : {type: \"Feature\", id: id, bbox: bbox, properties: properties, geometry: geometry};\n}\n\nexport function object(topology, o) {\n  var transformPoint = transform(topology.transform),\n      arcs = topology.arcs;\n\n  function arc(i, points) {\n    if (points.length) points.pop();\n    for (var a = arcs[i < 0 ? ~i : i], k = 0, n = a.length; k < n; ++k) {\n      points.push(transformPoint(a[k], k));\n    }\n    if (i < 0) reverse(points, n);\n  }\n\n  function point(p) {\n    return transformPoint(p);\n  }\n\n  function line(arcs) {\n    var points = [];\n    for (var i = 0, n = arcs.length; i < n; ++i) arc(arcs[i], points);\n    if (points.length < 2) points.push(points[0]); // This should never happen per the specification.\n    return points;\n  }\n\n  function ring(arcs) {\n    var points = line(arcs);\n    while (points.length < 4) points.push(points[0]); // This may happen if an arc has only two points.\n    return points;\n  }\n\n  function polygon(arcs) {\n    return arcs.map(ring);\n  }\n\n  function geometry(o) {\n    var type = o.type, coordinates;\n    switch (type) {\n      case \"GeometryCollection\": return {type: type, geometries: o.geometries.map(geometry)};\n      case \"Point\": coordinates = point(o.coordinates); break;\n      case \"MultiPoint\": coordinates = o.coordinates.map(point); break;\n      case \"LineString\": coordinates = line(o.arcs); break;\n      case \"MultiLineString\": coordinates = o.arcs.map(line); break;\n      case \"Polygon\": coordinates = polygon(o.arcs); break;\n      case \"MultiPolygon\": coordinates = o.arcs.map(polygon); break;\n      default: return null;\n    }\n    return {type: type, coordinates: coordinates};\n  }\n\n  return geometry(o);\n}\n","export default function(x) {\n  return x;\n}\n","import {object} from \"./feature\";\nimport stitch from \"./stitch\";\n\nfunction planarRingArea(ring) {\n  var i = -1, n = ring.length, a, b = ring[n - 1], area = 0;\n  while (++i < n) a = b, b = ring[i], area += a[0] * b[1] - a[1] * b[0];\n  return Math.abs(area); // Note: doubled area!\n}\n\nexport default function(topology) {\n  return object(topology, mergeArcs.apply(this, arguments));\n}\n\nexport function mergeArcs(topology, objects) {\n  var polygonsByArc = {},\n      polygons = [],\n      groups = [];\n\n  objects.forEach(geometry);\n\n  function geometry(o) {\n    switch (o.type) {\n      case \"GeometryCollection\": o.geometries.forEach(geometry); break;\n      case \"Polygon\": extract(o.arcs); break;\n      case \"MultiPolygon\": o.arcs.forEach(extract); break;\n    }\n  }\n\n  function extract(polygon) {\n    polygon.forEach(function(ring) {\n      ring.forEach(function(arc) {\n        (polygonsByArc[arc = arc < 0 ? ~arc : arc] || (polygonsByArc[arc] = [])).push(polygon);\n      });\n    });\n    polygons.push(polygon);\n  }\n\n  function area(ring) {\n    return planarRingArea(object(topology, {type: \"Polygon\", arcs: [ring]}).coordinates[0]);\n  }\n\n  polygons.forEach(function(polygon) {\n    if (!polygon._) {\n      var group = [],\n          neighbors = [polygon];\n      polygon._ = 1;\n      groups.push(group);\n      while (polygon = neighbors.pop()) {\n        group.push(polygon);\n        polygon.forEach(function(ring) {\n          ring.forEach(function(arc) {\n            polygonsByArc[arc < 0 ? ~arc : arc].forEach(function(polygon) {\n              if (!polygon._) {\n                polygon._ = 1;\n                neighbors.push(polygon);\n              }\n            });\n          });\n        });\n      }\n    }\n  });\n\n  polygons.forEach(function(polygon) {\n    delete polygon._;\n  });\n\n  return {\n    type: \"MultiPolygon\",\n    arcs: groups.map(function(polygons) {\n      var arcs = [], n;\n\n      // Extract the exterior (unique) arcs.\n      polygons.forEach(function(polygon) {\n        polygon.forEach(function(ring) {\n          ring.forEach(function(arc) {\n            if (polygonsByArc[arc < 0 ? ~arc : arc].length < 2) {\n              arcs.push(arc);\n            }\n          });\n        });\n      });\n\n      // Stitch the arcs into one or more rings.\n      arcs = stitch(topology, arcs);\n\n      // If more than one ring is returned,\n      // at most one of these rings can be the exterior;\n      // choose the one with the greatest absolute area.\n      if ((n = arcs.length) > 1) {\n        for (var i = 1, k = area(arcs[0]), ki, t; i < n; ++i) {\n          if ((ki = area(arcs[i])) > k) {\n            t = arcs[0], arcs[0] = arcs[i], arcs[i] = t, k = ki;\n          }\n        }\n      }\n\n      return arcs;\n    })\n  };\n}\n","import {object} from \"./feature\";\nimport stitch from \"./stitch\";\n\nexport default function(topology) {\n  return object(topology, meshArcs.apply(this, arguments));\n}\n\nexport function meshArcs(topology, object, filter) {\n  var arcs, i, n;\n  if (arguments.length > 1) arcs = extractArcs(topology, object, filter);\n  else for (i = 0, arcs = new Array(n = topology.arcs.length); i < n; ++i) arcs[i] = i;\n  return {type: \"MultiLineString\", arcs: stitch(topology, arcs)};\n}\n\nfunction extractArcs(topology, object, filter) {\n  var arcs = [],\n      geomsByArc = [],\n      geom;\n\n  function extract0(i) {\n    var j = i < 0 ? ~i : i;\n    (geomsByArc[j] || (geomsByArc[j] = [])).push({i: i, g: geom});\n  }\n\n  function extract1(arcs) {\n    arcs.forEach(extract0);\n  }\n\n  function extract2(arcs) {\n    arcs.forEach(extract1);\n  }\n\n  function extract3(arcs) {\n    arcs.forEach(extract2);\n  }\n\n  function geometry(o) {\n    switch (geom = o, o.type) {\n      case \"GeometryCollection\": o.geometries.forEach(geometry); break;\n      case \"LineString\": extract1(o.arcs); break;\n      case \"MultiLineString\": case \"Polygon\": extract2(o.arcs); break;\n      case \"MultiPolygon\": extract3(o.arcs); break;\n    }\n  }\n\n  geometry(object);\n\n  geomsByArc.forEach(filter == null\n      ? function(geoms) { arcs.push(geoms[0].i); }\n      : function(geoms) { if (filter(geoms[0].g, geoms[geoms.length - 1].g)) arcs.push(geoms[0].i); });\n\n  return arcs;\n}\n","import bisect from \"./bisect\";\n\nexport default function(objects) {\n  var indexesByArc = {}, // arc index -> array of object indexes\n      neighbors = objects.map(function() { return []; });\n\n  function line(arcs, i) {\n    arcs.forEach(function(a) {\n      if (a < 0) a = ~a;\n      var o = indexesByArc[a];\n      if (o) o.push(i);\n      else indexesByArc[a] = [i];\n    });\n  }\n\n  function polygon(arcs, i) {\n    arcs.forEach(function(arc) { line(arc, i); });\n  }\n\n  function geometry(o, i) {\n    if (o.type === \"GeometryCollection\") o.geometries.forEach(function(o) { geometry(o, i); });\n    else if (o.type in geometryType) geometryType[o.type](o.arcs, i);\n  }\n\n  var geometryType = {\n    LineString: line,\n    MultiLineString: polygon,\n    Polygon: polygon,\n    MultiPolygon: function(arcs, i) { arcs.forEach(function(arc) { polygon(arc, i); }); }\n  };\n\n  objects.forEach(geometry);\n\n  for (var i in indexesByArc) {\n    for (var indexes = indexesByArc[i], m = indexes.length, j = 0; j < m; ++j) {\n      for (var k = j + 1; k < m; ++k) {\n        var ij = indexes[j], ik = indexes[k], n;\n        if ((n = neighbors[ij])[i = bisect(n, ik)] !== ik) n.splice(i, 0, ik);\n        if ((n = neighbors[ik])[i = bisect(n, ij)] !== ij) n.splice(i, 0, ij);\n      }\n    }\n  }\n\n  return neighbors;\n}\n","import bbox from \"./bbox\";\nimport untransform from \"./untransform\";\n\nexport default function(topology, transform) {\n  if (topology.transform) throw new Error(\"already quantized\");\n\n  if (!transform || !transform.scale) {\n    if (!((n = Math.floor(transform)) >= 2)) throw new Error(\"n must be ≥2\");\n    box = topology.bbox || bbox(topology);\n    var x0 = box[0], y0 = box[1], x1 = box[2], y1 = box[3], n;\n    transform = {scale: [x1 - x0 ? (x1 - x0) / (n - 1) : 1, y1 - y0 ? (y1 - y0) / (n - 1) : 1], translate: [x0, y0]};\n  } else {\n    box = topology.bbox;\n  }\n\n  var t = untransform(transform), box, key, inputs = topology.objects, outputs = {};\n\n  function quantizePoint(point) {\n    return t(point);\n  }\n\n  function quantizeGeometry(input) {\n    var output;\n    switch (input.type) {\n      case \"GeometryCollection\": output = {type: \"GeometryCollection\", geometries: input.geometries.map(quantizeGeometry)}; break;\n      case \"Point\": output = {type: \"Point\", coordinates: quantizePoint(input.coordinates)}; break;\n      case \"MultiPoint\": output = {type: \"MultiPoint\", coordinates: input.coordinates.map(quantizePoint)}; break;\n      default: return input;\n    }\n    if (input.id != null) output.id = input.id;\n    if (input.bbox != null) output.bbox = input.bbox;\n    if (input.properties != null) output.properties = input.properties;\n    return output;\n  }\n\n  function quantizeArc(input) {\n    var i = 0, j = 1, n = input.length, p, output = new Array(n); // pessimistic\n    output[0] = t(input[0], 0);\n    while (++i < n) if ((p = t(input[i], i))[0] || p[1]) output[j++] = p; // non-coincident points\n    if (j === 1) output[j++] = [0, 0]; // an arc must have at least two points\n    output.length = j;\n    return output;\n  }\n\n  for (key in inputs) outputs[key] = quantizeGeometry(inputs[key]);\n\n  return {\n    type: \"Topology\",\n    bbox: box,\n    transform: transform,\n    objects: outputs,\n    arcs: topology.arcs.map(quantizeArc)\n  };\n}\n","export default function(array, n) {\n  var t, j = array.length, i = j - n;\n  while (i < --j) t = array[i], array[i++] = array[j], array[j] = t;\n}\n","export default function(topology, arcs) {\n  var stitchedArcs = {},\n      fragmentByStart = {},\n      fragmentByEnd = {},\n      fragments = [],\n      emptyIndex = -1;\n\n  // Stitch empty arcs first, since they may be subsumed by other arcs.\n  arcs.forEach(function(i, j) {\n    var arc = topology.arcs[i < 0 ? ~i : i], t;\n    if (arc.length < 3 && !arc[1][0] && !arc[1][1]) {\n      t = arcs[++emptyIndex], arcs[emptyIndex] = i, arcs[j] = t;\n    }\n  });\n\n  arcs.forEach(function(i) {\n    var e = ends(i),\n        start = e[0],\n        end = e[1],\n        f, g;\n\n    if (f = fragmentByEnd[start]) {\n      delete fragmentByEnd[f.end];\n      f.push(i);\n      f.end = end;\n      if (g = fragmentByStart[end]) {\n        delete fragmentByStart[g.start];\n        var fg = g === f ? f : f.concat(g);\n        fragmentByStart[fg.start = f.start] = fragmentByEnd[fg.end = g.end] = fg;\n      } else {\n        fragmentByStart[f.start] = fragmentByEnd[f.end] = f;\n      }\n    } else if (f = fragmentByStart[end]) {\n      delete fragmentByStart[f.start];\n      f.unshift(i);\n      f.start = start;\n      if (g = fragmentByEnd[start]) {\n        delete fragmentByEnd[g.end];\n        var gf = g === f ? f : g.concat(f);\n        fragmentByStart[gf.start = g.start] = fragmentByEnd[gf.end = f.end] = gf;\n      } else {\n        fragmentByStart[f.start] = fragmentByEnd[f.end] = f;\n      }\n    } else {\n      f = [i];\n      fragmentByStart[f.start = start] = fragmentByEnd[f.end = end] = f;\n    }\n  });\n\n  function ends(i) {\n    var arc = topology.arcs[i < 0 ? ~i : i], p0 = arc[0], p1;\n    if (topology.transform) p1 = [0, 0], arc.forEach(function(dp) { p1[0] += dp[0], p1[1] += dp[1]; });\n    else p1 = arc[arc.length - 1];\n    return i < 0 ? [p1, p0] : [p0, p1];\n  }\n\n  function flush(fragmentByEnd, fragmentByStart) {\n    for (var k in fragmentByEnd) {\n      var f = fragmentByEnd[k];\n      delete fragmentByStart[f.start];\n      delete f.start;\n      delete f.end;\n      f.forEach(function(i) { stitchedArcs[i < 0 ? ~i : i] = 1; });\n      fragments.push(f);\n    }\n  }\n\n  flush(fragmentByEnd, fragmentByStart);\n  flush(fragmentByStart, fragmentByEnd);\n  arcs.forEach(function(i) { if (!stitchedArcs[i < 0 ? ~i : i]) fragments.push([i]); });\n\n  return fragments;\n}\n","import identity from \"./identity\";\n\nexport default function(transform) {\n  if (transform == null) return identity;\n  var x0,\n      y0,\n      kx = transform.scale[0],\n      ky = transform.scale[1],\n      dx = transform.translate[0],\n      dy = transform.translate[1];\n  return function(input, i) {\n    if (!i) x0 = y0 = 0;\n    var j = 2, n = input.length, output = new Array(n);\n    output[0] = (x0 += input[0]) * kx + dx;\n    output[1] = (y0 += input[1]) * ky + dy;\n    while (j < n) output[j] = input[j], ++j;\n    return output;\n  };\n}\n","import identity from \"./identity\";\n\nexport default function(transform) {\n  if (transform == null) return identity;\n  var x0,\n      y0,\n      kx = transform.scale[0],\n      ky = transform.scale[1],\n      dx = transform.translate[0],\n      dy = transform.translate[1];\n  return function(input, i) {\n    if (!i) x0 = y0 = 0;\n    var j = 2,\n        n = input.length,\n        output = new Array(n),\n        x1 = Math.round((input[0] - dx) / kx),\n        y1 = Math.round((input[1] - dy) / ky);\n    output[0] = x1 - x0, x0 = x1;\n    output[1] = y1 - y0, y0 = y1;\n    while (j < n) output[j] = input[j], ++j;\n    return output;\n  };\n}\n","\"use strict\"\n\nmodule.exports = twoProduct\n\nvar SPLITTER = +(Math.pow(2, 27) + 1.0)\n\nfunction twoProduct(a, b, result) {\n  var x = a * b\n\n  var c = SPLITTER * a\n  var abig = c - a\n  var ahi = c - abig\n  var alo = a - ahi\n\n  var d = SPLITTER * b\n  var bbig = d - b\n  var bhi = d - bbig\n  var blo = b - bhi\n\n  var err1 = x - (ahi * bhi)\n  var err2 = err1 - (alo * bhi)\n  var err3 = err2 - (ahi * blo)\n\n  var y = alo * blo - err3\n\n  if(result) {\n    result[0] = y\n    result[1] = x\n    return result\n  }\n\n  return [ y, x ]\n}","\"use strict\"\n\nmodule.exports = fastTwoSum\n\nfunction fastTwoSum(a, b, result) {\n\tvar x = a + b\n\tvar bv = x - a\n\tvar av = x - bv\n\tvar br = b - bv\n\tvar ar = a - av\n\tif(result) {\n\t\tresult[0] = ar + br\n\t\tresult[1] = x\n\t\treturn result\n\t}\n\treturn [ar+br, x]\n}","import TileConversion from './TileConversion';\nimport TileLayer from './TileLayer';\nimport MapState from './MapState';\nimport MarkerRenderer from './MarkerRenderer';\nimport { defaultMapOptions } from './defaultOptions';\n\nexport default class Map {\n\n  constructor(canvas, options) {\n    if (!canvas || !canvas.getContext) {\n      throw new Error('Could not get canvas context');\n    }\n\n    this.canvas = canvas;\n    this.context = this.canvas.getContext('2d');\n\n    this.options = Object.assign({}, defaultMapOptions, options);\n\n    this.initializeState();\n    this.attachEvents();\n\n    this.lastDrawState = null;\n\n    /**\n     * Events\n     */\n    this.onMarkerClicked = null;\n    this.onMarkerHover = null;\n    this.onPolygonClicked = null;\n    this.onPolygonHover = null;\n\n    this.draw = this.draw.bind(this);\n    window.requestAnimationFrame(this.draw);\n  }\n\n  initializeState() {\n    this.state = {\n      canvasDimensions: [this.canvas.width, this.canvas.height],\n      tiles: {},\n      moveOffset: [0, 0],\n      targetMoveOffset: [0, 0],\n      targetMoveOffsetIsCoord: false,\n      moveAnimationStart: null,\n      dragStartPosition: null,\n      lastZoomEventActionTime: null,\n      startZoom: this.options.zoom,\n      targetZoom: this.options.zoom,\n      zoomAnimationStart: null,\n      scale: 1,\n      lastMouseMoveEvent: null,\n      mouseVelocities: [],\n      markerRenderer: new MarkerRenderer(),\n      polygons: [],\n      tileLayers: [\n        new TileLayer(this)\n      ],\n      mousePosition: { x: 0, y: 0},\n      forceRedraw: false\n    };\n  }\n\n  getZoom() {\n    return this.options.zoom;\n  }\n\n  setZoom(zoom) {\n    if (this.zoomValueIsValid(zoom) && this.isReadyForZoomEvent()) {\n      zoom = Math.round(zoom);\n\n      this.state.tileLayers.push(new TileLayer(this, zoom));\n      // this.state.tileLayers[0].tilesZoomLevel = this.options.zoom;\n\n      this.state.lastZoomEventActionTime = window.performance.now();\n      this.state.zoomAnimationStart = window.performance.now();\n      this.state.targetZoom = zoom;\n      this.state.startZoom = this.options.zoom;\n    }\n  }\n\n  setCenter(coord) {\n    if (!Array.isArray(coord) || coord.length !== 2) {\n      throw new Error('Please provide a valid array with a lat/lon');\n    }\n\n    coord = coord.map(coord => parseFloat(coord));\n\n    this.state.moveAnimationStart = window.performance.now();\n    this.state.targetMoveOffset = coord;\n    this.state.targetMoveOffsetIsCoord = true;\n  }\n\n  setTargetMoveOffset(x, y, animated = true) {\n    if (animated) {\n      this.state.moveAnimationStart = window.performance.now();\n\n      this.state.targetMoveOffset = TileConversion.pixelToLatLon(\n        [x, y],\n        this.options.center,\n        this.options.zoom,\n        this.options.tileSize\n      );\n\n      this.state.targetMoveOffsetIsCoord = true;\n    } else {\n      this.state.targetMoveOffset = [x, y];\n      this.state.targetMoveOffsetIsCoord = false;\n\n      this.state.moveOffset = this.state.targetMoveOffset;\n    }\n  }\n\n  zoomValueIsValid(zoom) {\n    return zoom >= 1 && zoom <= 18;\n  }\n\n  isReadyForZoomEvent() {\n    if (!this.state.lastZoomEventActionTime) {\n      return true;\n    }\n\n    const now = window.performance.now();\n    const milliSecondsSinceLastEvent = now - this.state.lastZoomEventActionTime;\n\n    return milliSecondsSinceLastEvent > this.options.debounceIntervalMs;\n  }\n\n  calculateVelocity(position1, position2, time1, time2) {\n    return ((position1 - position2) / (time1 - time2)) * 1000;\n  }\n\n  attachEvents() {\n    this.canvas.addEventListener('wheel', event => {\n      event.preventDefault();\n\n      if (event.deltaY > 5) {\n        this.setZoom(this.options.zoom - 1);\n      } else if (event.deltaY < -5) {\n        this.setZoom(this.options.zoom + 1);\n      }\n    });\n\n    this.canvas.addEventListener('dblclick', event => {\n      event.preventDefault();\n      this.updateMousePosition(event);\n\n      if (!this.handleMouseEventInteraction(event, 'dblclick')) {\n        const canvasCenter = this.getCanvasCenter();\n\n        this.setTargetMoveOffset(\n          -(this.state.mousePosition.x - canvasCenter[0]),\n          -(this.state.mousePosition.y - canvasCenter[1])\n        );\n\n        this.setZoom(this.options.zoom + 1);\n      }\n    });\n\n    this.canvas.addEventListener('mousedown', event => {\n      event.preventDefault();\n      this.updateMousePosition(event);\n\n      if (!this.handleMouseEventInteraction(event, 'mousedown')) {\n        this.state.mouseVelocities = [];\n\n        this.state.dragStartPosition = [\n          this.state.mousePosition.x - this.state.moveOffset[0],\n          this.state.mousePosition.y - this.state.moveOffset[1]\n        ];\n      }\n    });\n\n    this.canvas.addEventListener('mouseup', event => {\n      event.preventDefault();\n      this.updateMousePosition(event);\n\n      if (!this.state.dragStartPosition) {\n        this.handleMouseEventInteraction(event, 'mouseup');\n      } else {\n        const x = -(this.state.dragStartPosition[0] - this.state.mousePosition.x);\n        const y = -(this.state.dragStartPosition[1] - this.state.mousePosition.y);\n\n        this.state.dragStartPosition = null;\n\n        const dragDistanceBelowThreshold = Math.abs(x) <= 5 && Math.abs(y) <= 5;\n\n        if (dragDistanceBelowThreshold) {\n          this.handleMouseEventInteraction(event, 'mouseup');\n        } else {\n          if (this.state.moveOffset[0] !== 0 || this.state.moveOffset[1] !== 0) {\n            const now = window.performance.now();\n            const timingThreshold = now - this.options.throwTimingThresholdMs;\n\n            const thresholdsToConsider = this.state.mouseVelocities\n              .filter(threshold => threshold[0] > timingThreshold)\n              .map(threshold => threshold[1]);\n\n            const velocitySum = thresholdsToConsider.reduce(\n              (accumulator, velocity) => accumulator + velocity,\n              0\n            );\n\n            const averageVelocity = velocitySum / thresholdsToConsider.length;\n\n            if (averageVelocity >= this.options.throwVelocityThreshold) {\n              let multiplier = averageVelocity / this.options.throwVelocityThreshold\n                * this.options.panAccelerationMultiplier;\n\n              multiplier = Math.min(multiplier, this.options.maxPanAcceleration);\n\n              this.setTargetMoveOffset(\n                x * multiplier,\n                y * multiplier\n              );\n            } else {\n              this.updateCenter();\n            }\n          }\n        }\n      }\n    });\n\n    this.canvas.addEventListener('mousemove', event => {\n      event.preventDefault();\n      this.updateMousePosition(event);\n\n      if (this.state.dragStartPosition) {\n        const x = -(this.state.dragStartPosition[0] - this.state.mousePosition.x);\n        const y = -(this.state.dragStartPosition[1] - this.state.mousePosition.y);\n\n        const now = window.performance.now();\n\n        const vx = this.calculateVelocity(this.state.moveOffset[0], x, now, this.state.lastMouseMoveEvent);\n        const vy = this.calculateVelocity(this.state.moveOffset[1], y, now, this.state.lastMouseMoveEvent);\n\n        const velocity = Math.round(Math.sqrt((vx * vx) + (vy * vy)));\n\n        this.state.mouseVelocities.push([now, velocity]);\n\n        this.setTargetMoveOffset(x, y, false);\n        this.state.lastMouseMoveEvent = window.performance.now();\n      } else {\n        this.handleMouseEventInteraction(event, 'mousemove');\n      }\n\n      return false;\n    });\n  }\n\n  isCurrentlyDraggingMap() {\n    return this.state.dragStartPosition !== null;\n  }\n\n  enablePolygonInteractivity() {\n    return this.onPolygonHover || this.onPolygonClicked;\n  }\n\n  updateMousePosition(event) {\n    const rect = this.canvas.getBoundingClientRect();\n\n    this.state.mousePosition = {\n      x: event.clientX - rect.left,\n      y: event.clientY - rect.top\n    };\n  }\n\n  easeOutQuad(time) {\n    return time * (2 - time);\n  }\n\n  updateMoveOffset() {\n    const targetMoveOffsetChanged = this.state.moveOffset !== this.state.targetMoveOffset;\n\n    if (targetMoveOffsetChanged) {\n      const timestamp = window.performance.now();\n\n      const progress = Math.max(timestamp - this.state.moveAnimationStart, 0);\n      const percentage = this.easeOutQuad(progress / this.options.animationDurationMs);\n\n      let targetMoveOffset = this.state.targetMoveOffset;\n\n      if (this.state.targetMoveOffsetIsCoord) {\n        targetMoveOffset = TileConversion.latLonToPixel(\n          this.state.targetMoveOffset,\n          this.options.center,\n          this.options.zoom,\n          this.options.tileSize\n        );\n      }\n\n      if (percentage >= 0.99) {\n        this.state.moveOffset = targetMoveOffset;\n      } else {\n        this.state.moveOffset = [\n          this.state.moveOffset[0] + (targetMoveOffset[0] - this.state.moveOffset[0]) * percentage,\n          this.state.moveOffset[1] + (targetMoveOffset[1] - this.state.moveOffset[1]) * percentage\n        ];\n      }\n\n      const targetHasBeenReached = this.state.moveOffset === targetMoveOffset;\n\n      if (targetHasBeenReached) {\n        this.updateCenter();\n      }\n    }\n  }\n\n  updateCenter() {\n    const latLon = TileConversion.pixelToLatLon(\n      this.state.moveOffset,\n      this.options.center,\n      this.options.zoom,\n      this.options.tileSize\n    );\n\n    this.setTargetMoveOffset(0, 0, false);\n    this.options.center = latLon;\n  }\n\n  updateZoom() {\n    if (this.options.zoom !== this.state.targetZoom) {\n      const progress = Math.max(window.performance.now() - this.state.zoomAnimationStart, 0);\n      const percentage = this.easeOutQuad(progress / this.options.animationDurationMs);\n\n      let differenceFromTarget = Math.abs(this.state.targetZoom - this.state.startZoom);\n\n      if (this.state.targetZoom <= this.state.startZoom) {\n        differenceFromTarget *= -1;\n      }\n\n      const newZoomDiff = differenceFromTarget * percentage;\n      const remainingTime = this.options.animationDurationMs - progress;\n\n      this.options.zoom = remainingTime <= 5\n        ? this.state.targetZoom\n        : (this.state.startZoom + newZoomDiff);\n\n      const roundedZoom = Math.round(this.options.zoom);\n      const diff = this.options.zoom - roundedZoom;\n\n      this.state.scale = Math.pow(2, diff);\n\n      if (this.options.zoom === this.state.targetZoom) {\n        // Mark old tile layer for deletion\n        this.state.tileLayers.shift();\n        this.state.tileLayers[0].tilesZoomLevel = null;\n\n        // this.state.tileLayers[this.state.tileLayers.length - 1].shouldBeDeleted = true;\n      }\n    } else {\n      this.state.scale = 1;\n    }\n  }\n\n  garbageCollect() {\n    const allTiles = Object.values(this.state.tiles);\n\n    if (allTiles.length > this.maxTilesToKeep()) {\n      const tileExpirationCutOff = new Date().getTime() - 5000;\n\n      const tilesToConsider = allTiles\n        .filter(tile => tile.lastRequested < tileExpirationCutOff)\n        .sort((a, b) => ~~(a.lastRequested < b.lastRequested));\n\n      const tilesToDeleteCount = this.maxTilesToKeep() - (allTiles.length - tilesToConsider.length);\n\n      tilesToConsider\n        .splice(tilesToConsider.length - tilesToDeleteCount)\n        .forEach(tile => {\n          tile.src = '';\n          delete this.state.tiles[tile.tileId];\n        });\n    }\n  }\n\n  snapshotMapState() {\n    return new MapState(\n      this.options.center,\n      this.options.zoom,\n      this.state.targetZoom,\n      this.options.tileSize,\n      this.state.canvasDimensions,\n      this.getCanvasCenter(),\n      this.state.moveOffset\n    );\n  }\n\n  maxTilesToKeep() {\n    return 1000;\n  }\n\n  shouldRedraw() {\n    if (this.state.forceRedraw) {\n      this.state.forceRedraw = false;\n\n      return true;\n    }\n\n    const drawState = JSON.stringify([this.state, this.options]);\n\n    if (this.lastDrawState !== drawState) {\n      this.lastDrawState = drawState;\n\n      return true;\n    }\n\n    return false;\n  }\n\n  draw() {\n    this.updateMoveOffset();\n    this.updateZoom();\n    this.state.tileLayers.forEach(tileLayer => tileLayer.calculateGrid());\n    this.garbageCollect();\n\n    if (this.shouldRedraw()) {\n      // Delete tile layers that are ready for deletion and mostly loaded\n      /*\n      this.state.tileLayers = this.state.tileLayers\n        .filter(tileLayer => !(tileLayer.shouldBeDeleted && tileLayer.loadedPercentage() >= 0.9));\n\n      console.log(this.state.tileLayers.length);\n      */\n\n      if (this.state.tileLayers.length > 0) {\n        // Only draw the top layer\n        this.state.tileLayers[0].drawTiles(this.state.scale);\n      }\n\n      const mapState = this.snapshotMapState();\n\n      this.renderPolygons(mapState);\n      this.renderMarkers(mapState);\n      this.renderControls();\n      this.renderAttribution();\n    }\n\n    window.requestAnimationFrame(this.draw);\n  }\n\n  getMapBounds() {\n    const canvasCenter = this.getCanvasCenter();\n\n    const nw = TileConversion.pixelToLatLon(\n      [canvasCenter[0], canvasCenter[1]],\n      this.options.center,\n      this.options.zoom,\n      this.options.tileSize\n    );\n\n    const se = TileConversion.pixelToLatLon(\n      [-canvasCenter[0], -canvasCenter[1]],\n      this.options.center,\n      this.options.zoom,\n      this.options.tileSize\n    );\n\n    return {\n      nw, se\n    };\n  }\n\n  getCanvasCenter() {\n    return [\n      this.state.canvasDimensions[0] / 2,\n      this.state.canvasDimensions[1] / 2\n    ];\n  }\n\n  renderMarkers(mapState) {\n    this.state.markerRenderer.render(this.context, mapState, this.getMapBounds());\n  }\n\n  renderPolygons(mapState) {\n    this.state.polygons.map(polygon => {\n      polygon.render(this.context, mapState);\n\n      if (this.enablePolygonInteractivity() && !this.isCurrentlyDraggingMap()) {\n        polygon.handleMouseOver(this.context, mapState, this.state.mousePosition);\n      }\n    });\n  }\n\n  handleMouseEventInteraction(event, name) {\n    const controlObjects = this.getControlObjects().filter(item => this.isMouseOverObject(item.bounds));\n\n    const markers = controlObjects.length <= 0 && (this.onMarkerClicked || this.onMarkerHover)\n      ? this.getMarkersBounds(this.snapshotMapState()).filter(item => this.isMouseOverObject(item.bounds))\n      : [];\n\n    if (name === 'mouseup') {\n      if (controlObjects.length > 0) {\n        const controlObject = controlObjects[0];\n\n        this.setZoom(controlObject.label === '+'\n          ? this.options.zoom + 1\n          : this.options.zoom - 1);\n      }\n\n      if (this.onMarkerClicked) {\n        markers.map(item => this.onMarkerClicked(item.marker));\n      }\n    } else {\n      if (this.onMarkerHover) {\n        markers.map(item => this.onMarkerHover(item.marker));\n      }\n    }\n\n    let controlsOrMarkersIsHover = controlObjects.length > 0 || markers.length > 0;\n\n    let polygonIsHover = false;\n\n    if (this.enablePolygonInteractivity() && !this.isCurrentlyDraggingMap() && !controlsOrMarkersIsHover) {\n      let polygons = [];\n\n      const mapState = this.snapshotMapState();\n\n      polygons = this.state.polygons.map(polygon =>\n        polygon.handleMouseOver(null, mapState, this.state.mousePosition)\n      ).filter(polygon => polygon.length > 0);\n\n      polygonIsHover = polygons.length > 0;\n\n      if (polygonIsHover) {\n        const eventHandler = (name === 'mouseup')\n          ? this.onPolygonClicked\n          : this.onPolygonHover;\n\n        if (eventHandler) {\n          polygons.map(polygon => polygon.map(item => eventHandler(item)));\n        }\n      }\n    }\n\n    this.canvas.style.cursor = controlsOrMarkersIsHover || polygonIsHover\n      ? 'pointer'\n      : 'grab';\n\n    // Let caller know if controls or markers were interacted with. This will prevent further\n    // mouse interactions from being triggered\n    return controlsOrMarkersIsHover;\n  }\n\n  getControlObjects() {\n    const margin = 4;\n    const size = 30;\n\n    return [\n      {\n        bounds: {\n          x: margin,\n          y: margin,\n          width: size,\n          height: size\n        },\n        label: '+'\n      },\n      {\n        bounds: {\n          x: margin,\n          y: margin + size + margin,\n          width: size,\n          height: size\n        },\n        label: '-'\n      }\n    ];\n  }\n\n  renderControls() {\n    this.getControlObjects().map(item => this.renderControl(item.bounds, item.label));\n  }\n\n  renderControl(bounds, label) {\n    const radius = 10;\n\n    // Background\n    this.context.fillStyle = this.isMouseOverObject(bounds)\n      ? 'rgba(100, 100, 100, 0.7)'\n      : 'rgba(0, 0, 0, 0.7)';\n\n    this.roundedRectangle(bounds.x, bounds.y, bounds.width, bounds.height, radius);\n\n    // Text\n    this.context.font = 'bold 25px courier';\n    this.context.textAlign = 'center';\n    this.context.textBaseline = 'middle';\n    this.context.fillStyle = 'rgba(255, 255, 255)';\n\n    this.context.fillText(\n      label,\n      bounds.x + (bounds.width / 2),\n      bounds.y + (bounds.height / 2)\n    );\n  }\n\n  isMouseOverObject(bounds) {\n    return this.state.mousePosition.x >= bounds.x\n      && this.state.mousePosition.x <= bounds.x + bounds.width\n      && this.state.mousePosition.y >= bounds.y\n      && this.state.mousePosition.y <= bounds.y + bounds.height;\n  }\n\n  renderAttribution() {\n    const margin = 4;\n\n    this.context.font = 'bold 12px sans-serif';\n    this.context.textAlign = 'left';\n    this.context.textBaseline = 'alphabetic';\n\n    const textBounds = this.context.measureText(this.options.attribution);\n\n    const x = this.state.canvasDimensions[0] - textBounds.width - margin;\n    const y = this.state.canvasDimensions[1] - 2 - margin;\n\n    this.context.fillStyle = 'rgba(255, 255, 255, 0.7)';\n    this.roundedRectangle(x - margin, y - 15, textBounds.width + 80, 80);\n\n    this.context.fillStyle = 'rgba(0, 0, 0, 0.7)';\n    this.context.fillText(this.options.attribution, x, y);\n  }\n\n  roundedRectangle(x, y, width, height, radius = 5) {\n    this.context.beginPath();\n    this.context.moveTo(x + radius, y);\n    this.context.lineTo(x + width - radius, y);\n    this.context.quadraticCurveTo(x + width, y, x + width, y + radius);\n    this.context.lineTo(x + width, y + height - radius);\n    this.context.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\n    this.context.lineTo(x + radius, y + height);\n    this.context.quadraticCurveTo(x, y + height, x, y + height - radius);\n    this.context.lineTo(x, y + radius);\n    this.context.quadraticCurveTo(x, y, x + radius, y);\n    this.context.closePath();\n\n    this.context.fill();\n  }\n\n  addMarker(marker) {\n    this.state.markerRenderer.markers.push(marker);\n  }\n\n  addMarkers(markers) {\n    markers.map(marker => this.addMarker(marker));\n  }\n\n  setMarkers(markers) {\n    this.state.markerRenderer.markers = markers;\n    this.state.forceRedraw = true;\n  }\n\n  addPolygon(polygon) {\n    this.state.polygons.push(polygon);\n  }\n\n  setPolygons(polygons) {\n    this.state.polygons = polygons;\n  }\n\n}\n","export default class MapState {\n  constructor(center, zoom, targetZoom, tileSize, canvasDimensions, canvasCenter, moveOffset) {\n    this._center = center;\n    this._zoom = zoom;\n    this._targetZoom = targetZoom;\n    this._tileSize = tileSize;\n    this._canvasDimensions = canvasDimensions;\n    this._canvasCenter = canvasCenter;\n    this._moveOffset = moveOffset;\n  }\n\n  get center() {\n    return this._center;\n  }\n\n  get zoom() {\n    return this._zoom;\n  }\n\n  get targetZoom() {\n    return this._targetZoom;\n  }\n\n  get tileSize() {\n    return this._tileSize;\n  }\n\n  get canvasDimensions() {\n    return this._canvasDimensions;\n  }\n\n  get canvasCenter() {\n    return this._canvasCenter;\n  }\n\n  get moveOffset() {\n    return this._moveOffset;\n  }\n}\n","import { defaultMarkerOptions } from './defaultOptions';\n\nexport default class Marker {\n  constructor(coords, options = {}) {\n    this._coords = coords;\n    this._options = Object.assign({}, defaultMarkerOptions, options);\n  }\n\n  get coords() {\n    return this._coords;\n  }\n\n  get options() {\n    return this._options;\n  }\n\n  get size() {\n    switch (this.options.type) {\n      case 'marker':\n        return [\n          17.698069,\n          24.786272\n        ];\n\n      case 'circle': {\n        const strokeMargin = this.options.enableStroke\n          ? this.options.lineWidth\n          : 0;\n\n        return [10 + strokeMargin, 10 + strokeMargin];\n      }\n\n      case 'donut':\n        return [14, 14];\n\n      case 'image':\n        return this.options.image\n          ? [this.options.image.width, this.options.image.height]\n          : null;\n\n      default:\n        return null;\n    }\n  }\n\n  get offset() {\n    switch (this.options.type) {\n      case 'marker':\n        return [\n          0,\n          -(this.size[1] / 2)\n        ];\n\n      case 'image':\n        return this.options.offset;\n\n      default:\n        return [0, 0];\n    }\n  }\n\n  render(context, position) {\n    let renderFunction = null;\n\n    switch (this.options.type) {\n      case 'marker':\n        renderFunction = this.renderMarker;\n        break;\n\n      case 'circle':\n        renderFunction = this.renderCircle;\n        break;\n\n      case 'donut':\n        renderFunction = this.renderDonut;\n        break;\n\n      case 'image':\n        renderFunction = this.renderImage;\n        break;\n    }\n\n    if (!renderFunction) {\n      throw new Error(`Unsupported marker type: \"${this.options.type}\"`);\n    } else {\n      renderFunction = renderFunction.bind(this);\n      renderFunction(context, position);\n    }\n  }\n\n  renderCircle(context, position) {\n    context.fillStyle = this.options.color;\n    context.strokeStyle = this.options.strokeStyle;\n    context.lineWidth = this.options.lineWidth;\n\n    context.save();\n    context.beginPath();\n    context.arc(position[0], position[1], this.size[0] / 2, 0, 2 * Math.PI);\n    context.fill();\n\n    if (this.options.enableStroke) {\n      context.stroke();\n    }\n\n    context.restore();\n  }\n\n  renderDonut(context, position) {\n    context.fillStyle = this.options.color;\n    context.strokeStyle = this.options.color;\n\n    context.save();\n    context.beginPath();\n    context.lineWidth = 5;\n    context.arc(position[0], position[1], this.size[0] / 2, 0, 2 * Math.PI);\n    context.stroke();\n    context.restore();\n  }\n\n  renderMarker(context, position) {\n    context.fillStyle = this.options.color;\n    context.strokeStyle = this.options.color;\n\n    const size = this.size;\n\n    const x = position[0] - size[0] / 2;\n    const y = position[1] - size[1];\n\n    context.save();\n    context.transform(0.184386, 0.000000, 0.000000, 0.184386, 0.551658 + x, 4.095760 + y);\n    context.beginPath();\n    context.lineWidth = 1.667195;\n    context.moveTo(45.000000, -22.212949);\n    context.bezierCurveTo(18.494941, -22.212949, -2.991863, -0.726145, -2.991863, 25.778914);\n    context.bezierCurveTo(-2.991863, 52.282306, 45.000000, 112.212950, 45.000000, 112.212950);\n    context.bezierCurveTo(45.000000, 112.212950, 92.991863, 52.282306, 92.991863, 25.777247);\n    context.bezierCurveTo(92.991863, -0.726145, 71.505059, -22.212949, 45.000000, -22.212949);\n    context.moveTo(45.000000, 43.827962);\n    context.bezierCurveTo(33.553042, 43.827962, 24.273437, 34.550024, 24.273437, 23.103067);\n    context.bezierCurveTo(24.273437, 11.656109, 33.553042, 2.376504, 45.000000, 2.376504);\n    context.bezierCurveTo(56.446958, 2.376504, 65.726563, 11.654442, 65.726563, 23.101399);\n    context.bezierCurveTo(65.726563, 34.548357, 56.446958, 43.827962, 45.000000, 43.827962);\n    context.fill();\n    context.restore();\n  }\n\n  renderImage(context, position) {\n    if (this.options.image) {\n      const size = this.size;\n      const x = position[0] - size[0] / 2 + this.offset[0];\n      const y = position[1] - size[1] / 2 + this.offset[1];\n\n      context.drawImage(this.options.image, x, y, size[0], size[1]);\n    }\n  }\n}\n","import TileConversion from './TileConversion';\n\nexport default class MarkerRenderer {\n  constructor() {\n    this._markers = [];\n    this.offscreenCanvas = null;\n  }\n\n  get markers() {\n    return this._markers;\n  }\n\n  set markers(markers) {\n    this._markers = markers;\n  }\n\n  determineOriginZoom(mapState) {\n    let originZoom = mapState.zoom;\n\n    if (mapState.targetZoom > mapState.zoom) { // Zoming in\n      originZoom = Math.floor(mapState.zoom);\n    } else if (mapState.targetZoom < mapState.zoom) { // Zooming out\n      originZoom = Math.ceil(mapState.zoom);\n    }\n\n    return originZoom;\n  }\n\n  render(context, mapState, mapBounds) {\n    const originZoom = this.determineOriginZoom(mapState);\n\n    const zoomDiff = originZoom\n      ? mapState.zoom - originZoom\n      : 0;\n\n    const scale = zoomDiff !== 0\n      ? Math.pow(2, zoomDiff)\n      : 1.0;\n\n    if (this.shouldReRender(mapState, zoomDiff)) {\n      this.renderOffScreenCanvas(mapState, mapBounds);\n    }\n\n    if (scale < 1.5 || scale > 0.5) {\n      const canvasDrawPosition = [\n        mapState.moveOffset[0] - (mapState.canvasCenter[0] * (scale - 1)),\n        mapState.moveOffset[1] - (mapState.canvasCenter[1] * (scale - 1))\n      ];\n\n      const canvasDrawDimensions = [\n        mapState.canvasDimensions[0] * scale,\n        mapState.canvasDimensions[1] * scale\n      ];\n\n      context.drawImage(\n        this.offscreenCanvas,\n        canvasDrawPosition[0], canvasDrawPosition[1],\n        canvasDrawDimensions[0], canvasDrawDimensions[1],\n      );\n    }\n  }\n\n  shouldReRender(mapState, zoomDiff) {\n    const mapCenterChanged = this.renderedMapCenter !== mapState.center,\n      mapZoomChanged = (zoomDiff === 0 && this.renderedZoomLevel !== mapState.zoom);\n\n    return this.offscreenCanvas === null || mapCenterChanged || mapZoomChanged;\n  }\n\n  renderOffScreenCanvas(mapState, mapBounds) {\n    this.renderedZoomLevel = mapState.zoom;\n    this.renderedMapCenter = mapState.center;\n\n    const context = this.createOffscreenCanvas(mapState.canvasDimensions);\n    const visibleMarkers = this.getVisibleMarkers(mapBounds);\n\n    visibleMarkers.forEach(marker => {\n      const position = TileConversion.latLonToPixel(\n        marker.coords,\n        mapState.center,\n        mapState.zoom,\n        mapState.tileSize\n      );\n\n      marker.render(context, [\n        mapState.canvasCenter[0] - position[0],\n        mapState.canvasCenter[1] - position[1]\n      ]);\n    });\n  }\n\n  createOffscreenCanvas(canvasDimensions) {\n    this.offscreenCanvas = document.createElement('canvas');\n    this.offscreenCanvas.width = canvasDimensions[0];\n    this.offscreenCanvas.height = canvasDimensions[1];\n\n    return this.offscreenCanvas.getContext('2d');\n  }\n\n  getVisibleMarkers(bounds) {\n    return this.markers.filter(marker => {\n      return marker.coords[0] <= bounds.nw[0] && marker.coords[0] >= bounds.se[0]\n        && marker.coords[1] >= bounds.nw[1] && marker.coords[1] <= bounds.se[1];\n    });\n  }\n\n  getMarkersBounds(mapState) {\n    return this.getVisibleMarkers().map(marker => {\n      const position = TileConversion.latLonToPixel(\n        marker.coords,\n        mapState.center,\n        mapState.zoom,\n        mapState.tileSize\n      );\n\n      const markerSize = marker.size;\n      const markerOffset = marker.offset;\n\n      return {\n        bounds: {\n          x: mapState.canvasCenter[0] - position[0] + mapState.moveOffset[0] - (markerSize[0] / 2) + markerOffset[0],\n          y: mapState.canvasCenter[1] - position[1] + mapState.moveOffset[1] - (markerSize[1] / 2) + markerOffset[1],\n          width: markerSize[0],\n          height: markerSize[1]\n        },\n        marker\n      };\n    });\n  }\n}\n","import { defaultPolygonOptions, defaultPolygonHoverOptions } from './defaultOptions';\nimport TileConversion from './TileConversion';\nimport { feature } from 'topojson-client';\nimport classifyPoint from 'robust-point-in-polygon';\n\nexport default class Polygon {\n  constructor(json, objectName, options = {}, hoverOptions = null) {\n    this._options = Object.assign({}, defaultPolygonOptions, options);\n    this._hoverOptions = Object.assign({}, defaultPolygonOptions, defaultPolygonHoverOptions, hoverOptions);\n    this.globalIndex = this.prepareGlobalDataObject();\n\n    if (!objectName) {\n      objectName = Object.keys(json.objects)[0];\n    }\n\n    if (!(objectName in json.objects)) {\n      throw new Error(`Invalid object name, valid options are: ${Object.keys(json.objects).join(', ')}`);\n    }\n\n    this.geometry = feature(json, json.objects[objectName]);\n  }\n\n  get options() {\n    return this._options;\n  }\n\n  get hoverOptions() {\n    return this._hoverOptions;\n  }\n\n  get geometry() {\n    return window.lightningMapsPolygons[this.globalIndex].geometry;\n  }\n\n  set geometry(geometry) {\n    window.lightningMapsPolygons[this.globalIndex].geometry = geometry;\n  }\n\n  get projectedGeometry() {\n    return window.lightningMapsPolygons[this.globalIndex].projectedGeometry;\n  }\n\n  set projectedGeometry(projectedGeometry) {\n    window.lightningMapsPolygons[this.globalIndex].projectedGeometry = projectedGeometry;\n  }\n\n  prepareGlobalDataObject() {\n    if (!('lightningMapsPolygons' in window)) {\n      window.lightningMapsPolygons = [];\n    }\n\n    const index = window.lightningMapsPolygons.length;\n\n    window.lightningMapsPolygons[index] = {\n      geometry: null,\n      projectedGeometry: null\n    };\n\n    return index;\n  }\n\n  handleMouseOver(context, mapState, mousePosition) {\n    const currentlyZooming = Math.round(mapState.zoom) !== mapState.zoom;\n\n    if (!this.geometry || !this.projectedGeometry || currentlyZooming) {\n      return [];\n    }\n\n    const originZoom = this.determineOriginZoom(mapState);\n    const centerOffset = this.calculateCenterOffset(mapState, originZoom);\n    const point = [\n      mousePosition.x - centerOffset[0] - mapState.canvasCenter[0],\n      mousePosition.y - centerOffset[1] - mapState.canvasCenter[1]\n    ];\n\n    return this.projectedGeometry.filter(item => {\n      const isHover = item.geometry.filter(list => classifyPoint(list, point) === -1).length > 0;\n\n      if (isHover && context) {\n        context.beginPath();\n\n        item.geometry.map((list) => {\n          list.map((position, index) => {\n            position = [\n              position[0] + centerOffset[0] + mapState.canvasCenter[0],\n              position[1] + centerOffset[1] + mapState.canvasCenter[1]\n            ];\n\n            if (index === 0) {\n              context.moveTo(position[0], position[1]);\n            } else {\n              context.lineTo(position[0], position[1]);\n            }\n          });\n        });\n\n        this.applyContextStyles(context, this.hoverOptions, mapState.zoom);\n\n        if (this.options.enableStroke) context.fill();\n        if (this.options.enableFill) context.stroke();\n      }\n\n      return isHover;\n    });\n  }\n\n  calculateCenterOffset(mapState, originZoom) {\n    return [\n      -(TileConversion.lon2tile(mapState.center[1], originZoom, false) * mapState.tileSize),\n      -(TileConversion.lat2tile(mapState.center[0], originZoom, false) * mapState.tileSize)\n    ];\n  }\n\n  shouldReRender(mapState, zoomDiff) {\n    const mapCenterChanged = this.renderedMapCenter !== mapState.center,\n      mapZoomChanged = (zoomDiff === 0 && this.renderedZoomLevel !== mapState.zoom);\n\n    return mapCenterChanged || mapZoomChanged;\n  }\n\n  render(context, mapState) {\n    if (!this.geometry) {\n      return;\n    }\n\n    const originZoom = this.determineOriginZoom(mapState);\n\n    const zoomDiff = originZoom\n      ? mapState.zoom - originZoom\n      : 0;\n\n    const scale = zoomDiff !== 0\n      ? Math.pow(2, zoomDiff)\n      : 1;\n\n    if (this.shouldReRender(mapState, zoomDiff)) {\n      let centerOffset = null;\n\n      this.renderedZoomLevel = mapState.zoom;\n      this.renderedMapCenter = mapState.center;\n\n      this.projectedGeometry = this.geometry.features.map(feature => {\n        return {\n          ...feature,\n          geometry: this.projectGeometry(feature.geometry, mapState)\n        };\n      });\n\n      centerOffset = this.calculateCenterOffset(mapState, originZoom);\n\n      this.calculatePolygonExtends(centerOffset);\n\n      const imagePosition = [\n        mapState.canvasCenter[0] + mapState.moveOffset[0] + (this.polygonExtends.minX * scale),\n        mapState.canvasCenter[1] + mapState.moveOffset[1] + (this.polygonExtends.minY * scale)\n      ];\n\n      const imageRect = {\n        left: Math.floor(imagePosition[0] * -1),\n        right: Math.ceil(Math.abs(imagePosition[0]) + mapState.canvasDimensions[0]),\n        top: Math.floor(imagePosition[1] * -1),\n        bottom: Math.ceil(Math.abs(imagePosition[1]) + mapState.canvasDimensions[1])\n      };\n\n      this.renderOffscreenCanvas(mapState, centerOffset, imageRect);\n    }\n\n    const imageDrawPosition = [\n      mapState.moveOffset[0] - (mapState.canvasCenter[0] * (scale - 1)),\n      mapState.moveOffset[1] - (mapState.canvasCenter[1] * (scale - 1))\n    ];\n\n    const scaledWidth = this.polygonDimensions[0] * scale,\n      scaledHeight = this.polygonDimensions[1] * scale;\n\n    context.drawImage(\n      this.offscreenCanvas,\n      imageDrawPosition[0], imageDrawPosition[1],\n      scaledWidth, scaledHeight\n    );\n  }\n\n  determineOriginZoom(mapState) {\n    let originZoom = mapState.zoom;\n\n    if (mapState.targetZoom > mapState.zoom) { // Zoming in\n      originZoom = Math.floor(mapState.zoom);\n    } else if (mapState.targetZoom < mapState.zoom) { // Zooming out\n      originZoom = Math.ceil(mapState.zoom);\n    }\n\n    return originZoom;\n  }\n\n  createOffscreenCanvas(clipRect) {\n    this.polygonDimensions = [\n      clipRect.right - clipRect.left,\n      clipRect.bottom - clipRect.top\n    ];\n\n    this.offscreenCanvas = document.createElement('canvas');\n    this.offscreenCanvas.width = this.polygonDimensions[0];\n    this.offscreenCanvas.height = this.polygonDimensions[1];\n\n    return this.offscreenCanvas.getContext('2d');\n  }\n\n  calculatePolygonExtends(centerOffset) {\n    let minX, maxX, minY, maxY = null;\n\n    this.mapGeometry(position => {\n      position = [\n        position[0] + centerOffset[0],\n        position[1] + centerOffset[1]\n      ];\n\n      if (!maxX || position[0] > maxX) {\n        maxX = position[0];\n      }\n\n      if (!minX || position[0] < minX) {\n        minX = position[0];\n      }\n\n      if (!maxY || position[1] > maxY) {\n        maxY = position[1];\n      }\n\n      if (!minY || position[1] < minY) {\n        minY = position[1];\n      }\n    });\n\n    this.polygonDimensions = [\n      Math.ceil(maxX - minX),\n      Math.ceil(maxY - minY)\n    ];\n\n    this.polygonExtends = {\n      minX, maxX,\n      minY, maxY\n    };\n  }\n\n  renderOffscreenCanvas(mapState, centerOffset, clipRect) {\n    const offscreenContext = this.createOffscreenCanvas(clipRect);\n\n    offscreenContext.beginPath();\n    offscreenContext.font = 'bold 8px helvetica';\n\n    this.projectedGeometry.map((item) =>\n      item.geometry.map((list) => {\n        const pointsInClipRect = list.filter(position => {\n          position = [\n            position[0] - this.polygonExtends.minX + centerOffset[0],\n            position[1] - this.polygonExtends.minY + centerOffset[1]\n          ];\n\n          return position[0] >= clipRect.left && position[0] <= clipRect.right\n           && position[1] >= clipRect.top && position[1] <= clipRect.bottom;\n        });\n\n        if (pointsInClipRect.length > 0) {\n          list.map((position, index) => {\n            position = [\n              position[0] - this.polygonExtends.minX + centerOffset[0] - clipRect.left,\n              position[1] - this.polygonExtends.minY + centerOffset[1] - clipRect.top\n            ];\n\n            if (index === 0) {\n              // offscreenContext.fillText(item.properties.NAME, position[0], position[1]);\n\n              offscreenContext.moveTo(position[0], position[1]);\n            } else {\n              offscreenContext.lineTo(position[0], position[1]);\n            }\n          });\n        }\n      })\n    );\n\n    this.applyContextStyles(offscreenContext, this.options, mapState.zoom);\n\n    if (this.options.enableStroke) offscreenContext.fill();\n    if (this.options.enableFill) offscreenContext.stroke();\n  }\n\n  applyContextStyles(context, options, zoom) {\n    context.fillStyle = options.fillStyle;\n    context.strokeStyle = options.strokeStyle;\n    context.lineWidth = options.lineWidth * zoom;\n    context.setLineDash(options.lineDash);\n    context.lineJoin = 'round';\n  }\n\n  mapGeometry(pointCallback) {\n    return this.projectedGeometry.map((item) =>\n      item.geometry.map((list) =>\n        list.map(pointCallback)\n      )\n    );\n  }\n\n  projectGeometry(geometry, mapState) {\n    if (geometry) {\n      switch (geometry.type) {\n        case 'Polygon':\n          return [geometry.coordinates[0].map(item => this.projectPoint(mapState, item[0], item[1]))];\n\n        case 'MultiPolygon':\n          return geometry.coordinates.map(coordinates =>\n            coordinates[0].map(item => this.projectPoint(mapState, item[0], item[1]))\n          );\n      }\n    }\n\n    return [];\n  }\n\n  projectPoint(mapState, x, y) {\n    const position = TileConversion.latLonToPixel(\n      [y, x],\n      null,\n      mapState.zoom,\n      mapState.tileSize\n    );\n\n    return [-position[0], -position[1]];\n  }\n}\n","export default class Tile {\n  constructor(x, y, zoom) {\n    this._x = x;\n    this._y = y;\n    this._zoom = zoom;\n  }\n\n  get x() {\n    return this._x;\n  }\n\n  get y() {\n    return this._y;\n  }\n\n  get zoom() {\n    return this._zoom;\n  }\n\n  get id() {\n    return [this.x, this.y, this.zoom].join('|');\n  }\n\n  isValid() {\n    const max = (1 << this.zoom);\n\n    if (this.x >= max || this.x < 0 || this.y >= max || this.y < 0) {\n      return false;\n    }\n\n    return true;\n  }\n}\n","// Based on https://wiki.openstreetmap.org/wiki/Slippy_map_tilenames#ECMAScript_.28JavaScript.2FActionScript.2C_etc..29\nexport default class TileConversion {\n  static lon2tile(lon, zoom, rounded = true) {\n    const tile = (lon + 180) / 360 * Math.pow(2, zoom);\n\n    return rounded\n      ? Math.floor(tile)\n      : tile;\n  }\n\n  static lat2tile(lat, zoom, rounded = true) {\n    const tile = (1 - Math.log(Math.tan(lat * Math.PI / 180) + 1 / Math.cos(lat * Math.PI / 180))\n      / Math.PI) / 2 * Math.pow(2, zoom);\n\n    return rounded\n      ? Math.floor(tile)\n      : tile;\n  }\n\n  static tile2lon(x, z) {\n    return x / Math.pow(2, z) * 360 - 180;\n  }\n\n  static tile2lat(y, z) {\n    const n = Math.PI - 2 * Math.PI * y / Math.pow(2, z);\n\n    return 180 / Math.PI * Math.atan(0.5 * (Math.exp(n) - Math.exp(-n)));\n  }\n\n  static tile2boundingBox(x, y, zoom) {\n    return {\n      ne: [\n        TileConversion.tile2lat(y, zoom),\n        TileConversion.tile2lon(x + 1, zoom)\n      ],\n\n      sw: [\n        TileConversion.tile2lat(y + 1, zoom),\n        TileConversion.tile2lon(x, zoom)\n      ]\n    };\n  }\n\n  static pixelToLatLon(pixel, center, zoom, tileSize) {\n    const pointDiff = [\n      pixel[0] / tileSize,\n      pixel[1] / tileSize\n    ];\n\n    const tileX = TileConversion.lon2tile(center[1], zoom, false) - pointDiff[0];\n    const tileY = TileConversion.lat2tile(center[0], zoom, false) - pointDiff[1];\n\n    return [\n      TileConversion.tile2lat(tileY, zoom),\n      TileConversion.tile2lon(tileX, zoom)\n    ];\n  }\n\n  static latLonToPixel(coord, center, zoom, tileSize) {\n    const tileX = TileConversion.lon2tile(coord[1], zoom, false);\n    const tileY = TileConversion.lat2tile(coord[0], zoom, false);\n\n    let tileCenterX = 0, tileCenterY = 0;\n\n    if (center) {\n      tileCenterX = TileConversion.lon2tile(center[1], zoom, false);\n      tileCenterY = TileConversion.lat2tile(center[0], zoom, false);\n    }\n\n    return [\n      -(tileX - tileCenterX) * tileSize,\n      -(tileY - tileCenterY) * tileSize\n    ];\n  }\n}\n","import TileConversion from './TileConversion';\nimport Tile from './Tile';\n\nexport default class TileLayer {\n\n  constructor(map, tilesZoomLevel = null) {\n    this.map = map;\n    this.tilesZoomLevel = tilesZoomLevel;\n    this.shouldBeDeleted = false;\n\n    this.context = map.context;\n\n    this.state = {\n      grid: [],\n      gridHash: null,\n      relativeTileOffset: [0, 0]\n    };\n  }\n\n  toJSON() {\n    return [\n      this.state,\n      this.loadedPercentage() // We want a change in loaded tiles to possibly trigger a redraw\n    ];\n  }\n\n  getTilesCount(canvasSize) {\n    let tilesCount = Math.ceil(canvasSize / this.map.options.tileSize) * this.map.options.tileAreaMultiplier;\n\n    if (tilesCount % 2 === 0) {\n      tilesCount++;\n    }\n\n    return tilesCount;\n  }\n\n  calculateGrid() {\n    const { state, options } = this.map;\n\n    const centerY = TileConversion.lat2tile(options.center[0], Math.round(this.tilesZoomLevel || options.zoom), false);\n    const centerX = TileConversion.lon2tile(options.center[1], Math.round(this.tilesZoomLevel || options.zoom), false);\n    const gridHash = [centerY, centerX].join(',');\n\n    const gridNeedsToBeUpdated = this.state.gridHash !== gridHash;\n\n    if (!gridNeedsToBeUpdated) {\n      return;\n    }\n\n    const horizontalTiles = this.getTilesCount(state.canvasDimensions[0]);\n    const verticalTiles = this.getTilesCount(state.canvasDimensions[1]);\n\n    // noinspection JSSuspiciousNameCombination\n    const centerYRounded = Math.floor(centerY);\n    const centerXRounded = Math.floor(centerX);\n\n    this.state.relativeTileOffset = [\n      Math.abs(centerX - centerXRounded),\n      Math.abs(centerY - centerYRounded)\n    ];\n\n    const startX = centerXRounded - Math.floor(horizontalTiles / 2);\n    const startY = centerYRounded - Math.floor(verticalTiles / 2);\n\n    let grid = [];\n\n    for (let y = 0; y < verticalTiles; y++) {\n      for (let x = 0; x < horizontalTiles; x++) {\n        if (!grid[x]) {\n          grid[x] = [];\n        }\n\n        const tileX = startX + x;\n        const tileY = startY + y;\n\n        const tile = new Tile(tileX, tileY, Math.round(this.tilesZoomLevel || options.zoom));\n\n        if (tile.isValid()) {\n          this.ensureTileAsset(tile);\n          grid[x][y] = tile;\n        }\n      }\n    }\n\n    this.state.grid = grid;\n    this.state.gridHash = gridHash;\n  }\n\n  ensureTileAsset(tile) {\n    if (!(tile.id in this.map.state.tiles)) {\n      const tileUrl = this.map.options.source(Math.floor(tile.x), Math.floor(tile.y), tile.zoom);\n\n      this.map.state.tiles[tile.id] = new Image();\n      this.map.state.tiles[tile.id].tileId = tile.id;\n      this.map.state.tiles[tile.id].src = tileUrl;\n      this.map.state.tiles[tile.id].loaded = false;\n      this.map.state.tiles[tile.id].onload = () => {\n        this.map.state.tiles[tile.id].loaded = true;\n      };\n    }\n\n    this.map.state.tiles[tile.id].lastRequested = new Date().getTime();\n  }\n\n  drawTiles(scale) {\n    const canvasWidth = this.map.state.canvasDimensions[0];\n    const canvasHeight = this.map.state.canvasDimensions[1];\n\n    const tileSize = this.map.options.tileSize * scale;\n\n    const centerOffset = [\n      tileSize / 2 - (this.state.relativeTileOffset[0] * tileSize),\n      tileSize / 2 - (this.state.relativeTileOffset[1] * tileSize)\n    ];\n\n    this.context.fillStyle = '#EEE';\n    this.context.fillRect(0, 0, canvasWidth, canvasHeight);\n\n    const horizontalTiles = this.getTilesCount(canvasWidth);\n    const verticalTiles = this.getTilesCount(canvasHeight);\n\n    const horizontalOverflow = (horizontalTiles * tileSize) - canvasWidth;\n    const verticalOverflow = (verticalTiles * tileSize) - canvasHeight;\n\n    for (let y = 0; y < verticalTiles; y++) {\n      for (let x = 0; x < horizontalTiles; x++) {\n        const tile = this.state.grid[x][y];\n\n        if (tile) {\n          const tileX = this.map.state.moveOffset[0] + centerOffset[0]\n            + (x * tileSize - horizontalOverflow / 2);\n\n          const tileY = this.map.state.moveOffset[1] + centerOffset[1]\n            + (y * tileSize - verticalOverflow / 2);\n\n          try {\n            if (this.map.state.tiles[tile.id].loaded) {\n              this.context.drawImage(this.map.state.tiles[tile.id], tileX, tileY, tileSize, tileSize);\n            } else {\n              this.drawGenericBackground(tileX, tileY, tileSize);\n            }\n          } catch (err) {\n            this.drawGenericBackground(tileX, tileY, tileSize);\n          }\n\n          if (this.map.options.debug) {\n            this.context.strokeStyle = 'green';\n            this.context.strokeRect(tileX, tileY, tileSize, tileSize);\n          }\n        }\n      }\n    }\n\n    if (this.map.options.debug) {\n      this.context.fillStyle = 'rgba(200, 0, 0, 0.7)';\n      this.context.beginPath();\n      this.context.arc(canvasWidth / 2, canvasHeight / 2, 5, 0, 2 * Math.PI);\n      this.context.fill();\n    }\n  }\n\n  drawGenericBackground(x, y, size) {\n    const increment = size / 8;\n\n    this.context.beginPath();\n    for (let lineX = increment; lineX < size; lineX += increment) {\n      for (let lineY = increment; lineY < size; lineY += increment) {\n        this.context.moveTo(x, y + lineY);\n        this.context.lineTo(x + size, y + lineY);\n\n        this.context.moveTo(x + lineX, y);\n        this.context.lineTo(x + lineX, y + size);\n      }\n    }\n    this.context.strokeStyle = '#DDD';\n    this.context.stroke();\n\n    this.context.strokeStyle = '#CCC';\n    this.context.strokeRect(x, y, size, size);\n  }\n\n  loadedPercentage() {\n    const horizontalTiles = this.getTilesCount(this.map.state.canvasDimensions[0]);\n    const verticalTiles = this.getTilesCount(this.map.state.canvasDimensions[1]);\n\n    let totalTiles = 0, loadedTiles = 0;\n\n    for (let y = 0; y < verticalTiles; y++) {\n      for (let x = 0; x < horizontalTiles; x++) {\n        const tile = this.state.grid[x][y];\n\n        if (tile) {\n          totalTiles++;\n        }\n\n        const cachedTile = tile && this.map.state.tiles[tile.id];\n\n        if (cachedTile && cachedTile.loaded) {\n          loadedTiles++;\n        }\n      }\n    }\n\n    return loadedTiles / totalTiles;\n  }\n}\n","export const defaultMapOptions = {\n  /**\n   * Common options\n   */\n  source: (x, y, z) => `https://maps.geocod.io/tiles/base/${z}/${x}/${y}.png`,\n  zoom: 12,\n  center: [38.841779, -77.088312],\n  attribution: '© OpenStreetMap contributors',\n\n  /**\n   * Width and height in pixels for each tile, you most likely do not want to change this.\n   */\n  tileSize: 256,\n\n  /**\n   * Determines the distance travelled when panning the map, the higher the value the further the\n   * distance\n   */\n  panAccelerationMultiplier: 2,\n\n  /**\n   * The maximum acceleration constant for when the map is thrown. This is in place to avoid\n   * super-sonic acceleration speeds :)\n   */\n  maxPanAcceleration: 3.5,\n\n  /**\n   * Only consider high velocity mouse movements that has been performed within this timing\n   * threshold (in milliseconds)\n   */\n  throwTimingThresholdMs: 100,\n\n  /**\n   * If the mouse panning velocity is above this threshold, it is considering a throw rather than\n   * a regular pan. We use this to pan further when the mouse is moved quickly\n   */\n  throwVelocityThreshold: 3000,\n\n  /**\n   * How quickly panning and zooming animations are executed (in milliseconds)\n   */\n  animationDurationMs: 300,\n\n  /*\n   * Used for debouncing events such as scrolling\n   * Note: Needs to be greater than the animationDurationMs value\n   */\n  debounceIntervalMs: 350,\n\n  /**\n   * Determines how many additional tiles that should be loaded, to decrease map load times when\n   * panning the map around\n\n   * Minimum value: 1.25\n   */\n  tileAreaMultiplier: 2,\n\n  /**\n   * When debug mode is enabled, additional rendering artifacts are drawn. Should only be used in\n   * conjuction with development of the library\n   */\n  debug: false\n};\n\nexport const defaultMarkerOptions = {\n  /**\n   * What color should the marker be?\n   * Supports hex, rgb and rgba values\n   */\n  color: 'rgba(0, 0, 200, 0.7)',\n\n  /**\n   * Valid values: marker, circle, donut, image\n   */\n  type: 'marker',\n\n  /**\n   * Image object for the rendered icon\n   * Note: Only used for markers with the \"image\" type\n   */\n  image: null,\n\n  /**\n   * Horizontal and vertical offset.\n   * When the offset is set to [0,0], the image is centered horizontally and vertically.\n   * You might for example want add a vertical offset to teardrop-shaped marker icons\n   * Note: Only used for markers with the \"image\" type\n   */\n  offset: [0, 0],\n\n  /**\n   * Whether the marker should have a stroked line\n   * Only applicable when type is circle\n   */\n  enableStroke: false,\n\n  /**\n   * What color should the border be?\n   * Supports hex, rgb and rgba values\n   * Only applicable when enableStroke is true and type is circle\n   */\n  strokeStyle: 'rgba(100, 100, 100, 0.9)',\n\n  /**\n   * Specify the thickness of marker border\n   * Only applicable when enableStroke is true and type is circle\n   */\n  lineWidth: 2.5\n};\n\nexport const defaultPolygonOptions = {\n  /**\n   * Whether the polygon should have a stroked line\n   */\n  enableStroke: true,\n\n  /**\n   * What color should the polygon lines be?\n   * Supports hex, rgb and rgba values\n   */\n  strokeStyle: 'rgba(50, 25, 50, 1.0)',\n\n  /**\n   * Specify distances to alternately draw a line and a gap to form\n   * a dashed or dotted line. Line will be solid if array is empty\n   */\n  lineDash: [],\n\n  /**\n   * Specify the thickness of polygon lines. The width scales with the zoom level, so the actual\n   * width in pixels is: lineWidth * zoom\n   */\n  lineWidth: 0.25,\n\n  /**\n   * Whether the polygon should be filled with a color\n   */\n  enableFill: true,\n\n  /**\n   * What color should the polygon be filled with?\n   * Supports hex, rgb and rgba values\n   */\n  fillStyle: 'rgba(0, 0, 0, 0.2)'\n};\n\nexport const defaultPolygonHoverOptions = {\n  strokeStyle: 'red',\n  lineWidth: 0.5\n};\n\n","import Map from './Map';\nimport Marker from './Marker';\nimport Polygon from './Polygon';\n\nexport {\n  Map,\n  Marker,\n  Polygon\n};\n"],"sourceRoot":""}