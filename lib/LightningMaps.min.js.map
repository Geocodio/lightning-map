{"version":3,"sources":["webpack://LightningMaps/webpack/universalModuleDefinition","webpack://LightningMaps/webpack/bootstrap","webpack://LightningMaps/./node_modules/two-product/two-product.js","webpack://LightningMaps/./node_modules/robust-point-in-polygon/robust-pnp.js","webpack://LightningMaps/./node_modules/robust-orientation/orientation.js","webpack://LightningMaps/./node_modules/robust-sum/robust-sum.js","webpack://LightningMaps/./node_modules/robust-scale/robust-scale.js","webpack://LightningMaps/./node_modules/two-sum/two-sum.js","webpack://LightningMaps/./node_modules/robust-subtract/robust-diff.js","webpack://LightningMaps/./src/TileConversion.js","webpack://LightningMaps/./src/Tile.js","webpack://LightningMaps/./src/TileLayer.js","webpack://LightningMaps/./src/MapState.js","webpack://LightningMaps/./src/defaultOptions.js","webpack://LightningMaps/./src/Map.js","webpack://LightningMaps/./src/Marker.js","webpack://LightningMaps/./node_modules/topojson-client/src/identity.js","webpack://LightningMaps/./node_modules/topojson-client/src/transform.js","webpack://LightningMaps/./node_modules/topojson-client/src/reverse.js","webpack://LightningMaps/./node_modules/topojson-client/src/feature.js","webpack://LightningMaps/./node_modules/topojson-client/src/bisect.js","webpack://LightningMaps/./src/Polygon.js","webpack://LightningMaps/./src/index.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","a","b","result","x","SPLITTER","ahi","alo","bhi","blo","y","Math","pow","vs","point","length","inside","lim","j","yi","yj","orient","yk","x0","min","x1","max","k","px","y0","y1","twoProduct","robustSum","robustScale","robustSubtract","NUM_EXPAND","cofactor","Array","generateSum","expr","join","slice","determinant","push","orientation","pos","neg","matrix","args","apply","posExpr","negExpr","funcName","code","Function","proc","orientation3Exact","orientation4Exact","CACHED","det","tol","adx","bdx","cdx","ady","bdy","cdy","adz","bdz","cdz","bdxcdy","cdxbdy","cdxady","adxcdy","adxbdy","bdxady","abs","slowOrient","undefined","procArgs","concat","generateOrientationProc","e","f","ne","nf","bv","scalarScalar","g","count","eptr","fptr","ei","ea","fi","fa","_x","_bv","q0","q1","twoSum","scale","ts","q","pq","br","ar","TileConversion","lon","zoom","rounded","arguments","tile","floor","lat","log","tan","PI","cos","z","atan","exp","tile2lat","tile2lon","sw","pixel","center","tileSize","pointDiff","tileX","lon2tile","tileY","lat2tile","coord","tileCenterX","tileCenterY","Tile","Tile_classCallCheck","this","_y","_zoom","TileLayer","map","tilesZoomLevel","TileLayer_classCallCheck","shouldBeDeleted","context","state","grid","gridHash","relativeTileOffset","loadedPercentage","canvasSize","tilesCount","ceil","options","tileAreaMultiplier","_this$map","centerY","round","centerX","horizontalTiles","getTilesCount","canvasDimensions","verticalTiles","centerYRounded","centerXRounded","startX","startY","isValid","ensureTileAsset","_this","id","tiles","tileUrl","source","Image","tileId","src","loaded","onload","lastRequested","Date","getTime","canvasWidth","canvasHeight","centerOffset","fillStyle","fillRect","horizontalOverflow","verticalOverflow","moveOffset","drawImage","drawGenericBackground","err","debug","strokeStyle","strokeRect","beginPath","arc","fill","size","increment","lineX","lineY","moveTo","lineTo","stroke","totalTiles","loadedTiles","cachedTile","MapState","targetZoom","MapState_classCallCheck","_center","_targetZoom","_tileSize","_canvasDimensions","_moveOffset","defaultMapOptions","attribution","panAccelerationMultiplier","maxPanAcceleration","throwTimingThresholdMs","throwVelocityThreshold","animationDurationMs","debounceIntervalMs","defaultMarkerOptions","color","type","image","offset","defaultPolygonOptions","enableStroke","lineDash","lineWidth","enableFill","defaultPolygonHoverOptions","Map","canvas","Map_classCallCheck","getContext","Error","assign","initializeState","attachEvents","lastDrawState","onMarkerClicked","onMarkerHover","onPolygonClicked","onPolygonHover","draw","requestAnimationFrame","width","height","targetMoveOffset","targetMoveOffsetIsCoord","moveAnimationStart","dragStartPosition","lastZoomEventActionTime","startZoom","zoomAnimationStart","lastMouseMoveEvent","mouseVelocities","markers","polygons","tileLayers","mousePosition","forceRedraw","zoomValueIsValid","isReadyForZoomEvent","performance","now","isArray","parseFloat","pixelToLatLon","position1","position2","time1","time2","addEventListener","event","preventDefault","deltaY","setZoom","updateMousePosition","canvasCenter","getCanvasCenter","setTargetMoveOffset","handleMouseEventInteraction","timingThreshold","thresholdsToConsider","filter","threshold","averageVelocity","reduce","accumulator","velocity","multiplier","updateCenter","vx","calculateVelocity","vy","sqrt","rect","getBoundingClientRect","clientX","left","clientY","top","time","timestamp","progress","percentage","easeOutQuad","latLonToPixel","latLon","differenceFromTarget","newZoomDiff","remainingTime","roundedZoom","diff","shift","_this2","allTiles","values","maxTilesToKeep","tileExpirationCutOff","tilesToConsider","sort","tilesToDeleteCount","splice","forEach","drawState","JSON","stringify","updateMoveOffset","updateZoom","tileLayer","calculateGrid","garbageCollect","shouldRedraw","drawTiles","renderPolygons","renderMarkers","renderControls","renderAttribution","nw","se","bounds","getMapBounds","marker","coords","_this3","visibleMarkers","getVisibleMarkers","position","render","_this4","mapState","polygon","enablePolygonInteractivity","isCurrentlyDraggingMap","handleMouseOver","_this5","controlObjects","getControlObjects","item","isMouseOverObject","getMarkersBounds","controlObject","label","controlsOrMarkersIsHover","polygonIsHover","eventHandler","style","cursor","margin","_this6","markerSize","markerOffset","_this7","renderControl","roundedRectangle","font","textAlign","textBaseline","fillText","textBounds","measureText","radius","quadraticCurveTo","closePath","_this8","addMarker","Marker","Marker_classCallCheck","_coords","_options","renderFunction","renderMarker","renderCircle","renderDonut","renderImage","save","restore","transform","bezierCurveTo","identity","src_transform","kx","ky","dx","translate","dy","input","output","reverse","array","feature","topology","features","geometries","feature_feature","bbox","properties","geometry","feature_object","transformPoint","arcs","points","pop","line","ring","coordinates","Polygon","json","objectName","hoverOptions","Polygon_classCallCheck","_hoverOptions","globalIndex","prepareGlobalDataObject","keys","objects","lightningMapsPolygons","index","projectedGeometry","currentlyZooming","originZoom","determineOriginZoom","calculateCenterOffset","isHover","list","classifyPoint","applyContextStyles","zoomDiff","mapCenterChanged","renderedMapCenter","mapZoomChanged","renderedZoomLevel","shouldReRender","_objectSpread","projectGeometry","calculatePolygonExtends","imagePosition","polygonExtends","minX","minY","imageRect","right","bottom","renderOffscreenCanvas","imageDrawPosition","scaledWidth","polygonDimensions","scaledHeight","offscreenCanvas","clipRect","document","createElement","maxX","maxY","mapGeometry","offscreenContext","createOffscreenCanvas","setLineDash","lineJoin","pointCallback","projectPoint","__webpack_exports__","Map_Map","Marker_Marker","Polygon_Polygon"],"mappings":"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","file":"LightningMaps.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"LightningMaps\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"LightningMaps\"] = factory();\n\telse\n\t\troot[\"LightningMaps\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n","\"use strict\"\n\nmodule.exports = twoProduct\n\nvar SPLITTER = +(Math.pow(2, 27) + 1.0)\n\nfunction twoProduct(a, b, result) {\n  var x = a * b\n\n  var c = SPLITTER * a\n  var abig = c - a\n  var ahi = c - abig\n  var alo = a - ahi\n\n  var d = SPLITTER * b\n  var bbig = d - b\n  var bhi = d - bbig\n  var blo = b - bhi\n\n  var err1 = x - (ahi * bhi)\n  var err2 = err1 - (alo * bhi)\n  var err3 = err2 - (ahi * blo)\n\n  var y = alo * blo - err3\n\n  if(result) {\n    result[0] = y\n    result[1] = x\n    return result\n  }\n\n  return [ y, x ]\n}","module.exports = robustPointInPolygon\n\nvar orient = require('robust-orientation')\n\nfunction robustPointInPolygon(vs, point) {\n  var x = point[0]\n  var y = point[1]\n  var n = vs.length\n  var inside = 1\n  var lim = n\n  for(var i = 0, j = n-1; i<lim; j=i++) {\n    var a = vs[i]\n    var b = vs[j]\n    var yi = a[1]\n    var yj = b[1]\n    if(yj < yi) {\n      if(yj < y && y < yi) {\n        var s = orient(a, b, point)\n        if(s === 0) {\n          return 0\n        } else {\n          inside ^= (0 < s)|0\n        }\n      } else if(y === yi) {\n        var c = vs[(i+1)%n]\n        var yk = c[1]\n        if(yi < yk) {\n          var s = orient(a, b, point)\n          if(s === 0) {\n            return 0\n          } else {\n            inside ^= (0 < s)|0\n          }\n        }\n      }\n    } else if(yi < yj) {\n      if(yi < y && y < yj) {\n        var s = orient(a, b, point)\n        if(s === 0) {\n          return 0\n        } else {\n          inside ^= (s < 0)|0\n        }\n      } else if(y === yi) {\n        var c = vs[(i+1)%n]\n        var yk = c[1]\n        if(yk < yi) {\n          var s = orient(a, b, point)\n          if(s === 0) {\n            return 0\n          } else {\n            inside ^= (s < 0)|0\n          }\n        }\n      }\n    } else if(y === yi) {\n      var x0 = Math.min(a[0], b[0])\n      var x1 = Math.max(a[0], b[0])\n      if(i === 0) {\n        while(j>0) {\n          var k = (j+n-1)%n\n          var p = vs[k]\n          if(p[1] !== y) {\n            break\n          }\n          var px = p[0]\n          x0 = Math.min(x0, px)\n          x1 = Math.max(x1, px)\n          j = k\n        }\n        if(j === 0) {\n          if(x0 <= x && x <= x1) {\n            return 0\n          }\n          return 1 \n        }\n        lim = j+1\n      }\n      var y0 = vs[(j+n-1)%n][1]\n      while(i+1<lim) {\n        var p = vs[i+1]\n        if(p[1] !== y) {\n          break\n        }\n        var px = p[0]\n        x0 = Math.min(x0, px)\n        x1 = Math.max(x1, px)\n        i += 1\n      }\n      if(x0 <= x && x <= x1) {\n        return 0\n      }\n      var y1 = vs[(i+1)%n][1]\n      if(x < x0 && (y0 < y !== y1 < y)) {\n        inside ^= 1\n      }\n    }\n  }\n  return 2 * inside - 1\n}","\"use strict\"\n\nvar twoProduct = require(\"two-product\")\nvar robustSum = require(\"robust-sum\")\nvar robustScale = require(\"robust-scale\")\nvar robustSubtract = require(\"robust-subtract\")\n\nvar NUM_EXPAND = 5\n\nvar EPSILON     = 1.1102230246251565e-16\nvar ERRBOUND3   = (3.0 + 16.0 * EPSILON) * EPSILON\nvar ERRBOUND4   = (7.0 + 56.0 * EPSILON) * EPSILON\n\nfunction cofactor(m, c) {\n  var result = new Array(m.length-1)\n  for(var i=1; i<m.length; ++i) {\n    var r = result[i-1] = new Array(m.length-1)\n    for(var j=0,k=0; j<m.length; ++j) {\n      if(j === c) {\n        continue\n      }\n      r[k++] = m[i][j]\n    }\n  }\n  return result\n}\n\nfunction matrix(n) {\n  var result = new Array(n)\n  for(var i=0; i<n; ++i) {\n    result[i] = new Array(n)\n    for(var j=0; j<n; ++j) {\n      result[i][j] = [\"m\", j, \"[\", (n-i-1), \"]\"].join(\"\")\n    }\n  }\n  return result\n}\n\nfunction sign(n) {\n  if(n & 1) {\n    return \"-\"\n  }\n  return \"\"\n}\n\nfunction generateSum(expr) {\n  if(expr.length === 1) {\n    return expr[0]\n  } else if(expr.length === 2) {\n    return [\"sum(\", expr[0], \",\", expr[1], \")\"].join(\"\")\n  } else {\n    var m = expr.length>>1\n    return [\"sum(\", generateSum(expr.slice(0, m)), \",\", generateSum(expr.slice(m)), \")\"].join(\"\")\n  }\n}\n\nfunction determinant(m) {\n  if(m.length === 2) {\n    return [[\"sum(prod(\", m[0][0], \",\", m[1][1], \"),prod(-\", m[0][1], \",\", m[1][0], \"))\"].join(\"\")]\n  } else {\n    var expr = []\n    for(var i=0; i<m.length; ++i) {\n      expr.push([\"scale(\", generateSum(determinant(cofactor(m, i))), \",\", sign(i), m[0][i], \")\"].join(\"\"))\n    }\n    return expr\n  }\n}\n\nfunction orientation(n) {\n  var pos = []\n  var neg = []\n  var m = matrix(n)\n  var args = []\n  for(var i=0; i<n; ++i) {\n    if((i&1)===0) {\n      pos.push.apply(pos, determinant(cofactor(m, i)))\n    } else {\n      neg.push.apply(neg, determinant(cofactor(m, i)))\n    }\n    args.push(\"m\" + i)\n  }\n  var posExpr = generateSum(pos)\n  var negExpr = generateSum(neg)\n  var funcName = \"orientation\" + n + \"Exact\"\n  var code = [\"function \", funcName, \"(\", args.join(), \"){var p=\", posExpr, \",n=\", negExpr, \",d=sub(p,n);\\\nreturn d[d.length-1];};return \", funcName].join(\"\")\n  var proc = new Function(\"sum\", \"prod\", \"scale\", \"sub\", code)\n  return proc(robustSum, twoProduct, robustScale, robustSubtract)\n}\n\nvar orientation3Exact = orientation(3)\nvar orientation4Exact = orientation(4)\n\nvar CACHED = [\n  function orientation0() { return 0 },\n  function orientation1() { return 0 },\n  function orientation2(a, b) { \n    return b[0] - a[0]\n  },\n  function orientation3(a, b, c) {\n    var l = (a[1] - c[1]) * (b[0] - c[0])\n    var r = (a[0] - c[0]) * (b[1] - c[1])\n    var det = l - r\n    var s\n    if(l > 0) {\n      if(r <= 0) {\n        return det\n      } else {\n        s = l + r\n      }\n    } else if(l < 0) {\n      if(r >= 0) {\n        return det\n      } else {\n        s = -(l + r)\n      }\n    } else {\n      return det\n    }\n    var tol = ERRBOUND3 * s\n    if(det >= tol || det <= -tol) {\n      return det\n    }\n    return orientation3Exact(a, b, c)\n  },\n  function orientation4(a,b,c,d) {\n    var adx = a[0] - d[0]\n    var bdx = b[0] - d[0]\n    var cdx = c[0] - d[0]\n    var ady = a[1] - d[1]\n    var bdy = b[1] - d[1]\n    var cdy = c[1] - d[1]\n    var adz = a[2] - d[2]\n    var bdz = b[2] - d[2]\n    var cdz = c[2] - d[2]\n    var bdxcdy = bdx * cdy\n    var cdxbdy = cdx * bdy\n    var cdxady = cdx * ady\n    var adxcdy = adx * cdy\n    var adxbdy = adx * bdy\n    var bdxady = bdx * ady\n    var det = adz * (bdxcdy - cdxbdy) \n            + bdz * (cdxady - adxcdy)\n            + cdz * (adxbdy - bdxady)\n    var permanent = (Math.abs(bdxcdy) + Math.abs(cdxbdy)) * Math.abs(adz)\n                  + (Math.abs(cdxady) + Math.abs(adxcdy)) * Math.abs(bdz)\n                  + (Math.abs(adxbdy) + Math.abs(bdxady)) * Math.abs(cdz)\n    var tol = ERRBOUND4 * permanent\n    if ((det > tol) || (-det > tol)) {\n      return det\n    }\n    return orientation4Exact(a,b,c,d)\n  }\n]\n\nfunction slowOrient(args) {\n  var proc = CACHED[args.length]\n  if(!proc) {\n    proc = CACHED[args.length] = orientation(args.length)\n  }\n  return proc.apply(undefined, args)\n}\n\nfunction generateOrientationProc() {\n  while(CACHED.length <= NUM_EXPAND) {\n    CACHED.push(orientation(CACHED.length))\n  }\n  var args = []\n  var procArgs = [\"slow\"]\n  for(var i=0; i<=NUM_EXPAND; ++i) {\n    args.push(\"a\" + i)\n    procArgs.push(\"o\" + i)\n  }\n  var code = [\n    \"function getOrientation(\", args.join(), \"){switch(arguments.length){case 0:case 1:return 0;\"\n  ]\n  for(var i=2; i<=NUM_EXPAND; ++i) {\n    code.push(\"case \", i, \":return o\", i, \"(\", args.slice(0, i).join(), \");\")\n  }\n  code.push(\"}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation\")\n  procArgs.push(code.join(\"\"))\n\n  var proc = Function.apply(undefined, procArgs)\n  module.exports = proc.apply(undefined, [slowOrient].concat(CACHED))\n  for(var i=0; i<=NUM_EXPAND; ++i) {\n    module.exports[i] = CACHED[i]\n  }\n}\n\ngenerateOrientationProc()","\"use strict\"\n\nmodule.exports = linearExpansionSum\n\n//Easy case: Add two scalars\nfunction scalarScalar(a, b) {\n  var x = a + b\n  var bv = x - a\n  var av = x - bv\n  var br = b - bv\n  var ar = a - av\n  var y = ar + br\n  if(y) {\n    return [y, x]\n  }\n  return [x]\n}\n\nfunction linearExpansionSum(e, f) {\n  var ne = e.length|0\n  var nf = f.length|0\n  if(ne === 1 && nf === 1) {\n    return scalarScalar(e[0], f[0])\n  }\n  var n = ne + nf\n  var g = new Array(n)\n  var count = 0\n  var eptr = 0\n  var fptr = 0\n  var abs = Math.abs\n  var ei = e[eptr]\n  var ea = abs(ei)\n  var fi = f[fptr]\n  var fa = abs(fi)\n  var a, b\n  if(ea < fa) {\n    b = ei\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n      ea = abs(ei)\n    }\n  } else {\n    b = fi\n    fptr += 1\n    if(fptr < nf) {\n      fi = f[fptr]\n      fa = abs(fi)\n    }\n  }\n  if((eptr < ne && ea < fa) || (fptr >= nf)) {\n    a = ei\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n      ea = abs(ei)\n    }\n  } else {\n    a = fi\n    fptr += 1\n    if(fptr < nf) {\n      fi = f[fptr]\n      fa = abs(fi)\n    }\n  }\n  var x = a + b\n  var bv = x - a\n  var y = b - bv\n  var q0 = y\n  var q1 = x\n  var _x, _bv, _av, _br, _ar\n  while(eptr < ne && fptr < nf) {\n    if(ea < fa) {\n      a = ei\n      eptr += 1\n      if(eptr < ne) {\n        ei = e[eptr]\n        ea = abs(ei)\n      }\n    } else {\n      a = fi\n      fptr += 1\n      if(fptr < nf) {\n        fi = f[fptr]\n        fa = abs(fi)\n      }\n    }\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    }\n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n  }\n  while(eptr < ne) {\n    a = ei\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    }\n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n    }\n  }\n  while(fptr < nf) {\n    a = fi\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    } \n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n    fptr += 1\n    if(fptr < nf) {\n      fi = f[fptr]\n    }\n  }\n  if(q0) {\n    g[count++] = q0\n  }\n  if(q1) {\n    g[count++] = q1\n  }\n  if(!count) {\n    g[count++] = 0.0  \n  }\n  g.length = count\n  return g\n}","\"use strict\"\n\nvar twoProduct = require(\"two-product\")\nvar twoSum = require(\"two-sum\")\n\nmodule.exports = scaleLinearExpansion\n\nfunction scaleLinearExpansion(e, scale) {\n  var n = e.length\n  if(n === 1) {\n    var ts = twoProduct(e[0], scale)\n    if(ts[0]) {\n      return ts\n    }\n    return [ ts[1] ]\n  }\n  var g = new Array(2 * n)\n  var q = [0.1, 0.1]\n  var t = [0.1, 0.1]\n  var count = 0\n  twoProduct(e[0], scale, q)\n  if(q[0]) {\n    g[count++] = q[0]\n  }\n  for(var i=1; i<n; ++i) {\n    twoProduct(e[i], scale, t)\n    var pq = q[1]\n    twoSum(pq, t[0], q)\n    if(q[0]) {\n      g[count++] = q[0]\n    }\n    var a = t[1]\n    var b = q[1]\n    var x = a + b\n    var bv = x - a\n    var y = b - bv\n    q[1] = x\n    if(y) {\n      g[count++] = y\n    }\n  }\n  if(q[1]) {\n    g[count++] = q[1]\n  }\n  if(count === 0) {\n    g[count++] = 0.0\n  }\n  g.length = count\n  return g\n}","\"use strict\"\n\nmodule.exports = fastTwoSum\n\nfunction fastTwoSum(a, b, result) {\n\tvar x = a + b\n\tvar bv = x - a\n\tvar av = x - bv\n\tvar br = b - bv\n\tvar ar = a - av\n\tif(result) {\n\t\tresult[0] = ar + br\n\t\tresult[1] = x\n\t\treturn result\n\t}\n\treturn [ar+br, x]\n}","\"use strict\"\n\nmodule.exports = robustSubtract\n\n//Easy case: Add two scalars\nfunction scalarScalar(a, b) {\n  var x = a + b\n  var bv = x - a\n  var av = x - bv\n  var br = b - bv\n  var ar = a - av\n  var y = ar + br\n  if(y) {\n    return [y, x]\n  }\n  return [x]\n}\n\nfunction robustSubtract(e, f) {\n  var ne = e.length|0\n  var nf = f.length|0\n  if(ne === 1 && nf === 1) {\n    return scalarScalar(e[0], -f[0])\n  }\n  var n = ne + nf\n  var g = new Array(n)\n  var count = 0\n  var eptr = 0\n  var fptr = 0\n  var abs = Math.abs\n  var ei = e[eptr]\n  var ea = abs(ei)\n  var fi = -f[fptr]\n  var fa = abs(fi)\n  var a, b\n  if(ea < fa) {\n    b = ei\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n      ea = abs(ei)\n    }\n  } else {\n    b = fi\n    fptr += 1\n    if(fptr < nf) {\n      fi = -f[fptr]\n      fa = abs(fi)\n    }\n  }\n  if((eptr < ne && ea < fa) || (fptr >= nf)) {\n    a = ei\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n      ea = abs(ei)\n    }\n  } else {\n    a = fi\n    fptr += 1\n    if(fptr < nf) {\n      fi = -f[fptr]\n      fa = abs(fi)\n    }\n  }\n  var x = a + b\n  var bv = x - a\n  var y = b - bv\n  var q0 = y\n  var q1 = x\n  var _x, _bv, _av, _br, _ar\n  while(eptr < ne && fptr < nf) {\n    if(ea < fa) {\n      a = ei\n      eptr += 1\n      if(eptr < ne) {\n        ei = e[eptr]\n        ea = abs(ei)\n      }\n    } else {\n      a = fi\n      fptr += 1\n      if(fptr < nf) {\n        fi = -f[fptr]\n        fa = abs(fi)\n      }\n    }\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    }\n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n  }\n  while(eptr < ne) {\n    a = ei\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    }\n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n    }\n  }\n  while(fptr < nf) {\n    a = fi\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    } \n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n    fptr += 1\n    if(fptr < nf) {\n      fi = -f[fptr]\n    }\n  }\n  if(q0) {\n    g[count++] = q0\n  }\n  if(q1) {\n    g[count++] = q1\n  }\n  if(!count) {\n    g[count++] = 0.0  \n  }\n  g.length = count\n  return g\n}","// Based on https://wiki.openstreetmap.org/wiki/Slippy_map_tilenames#ECMAScript_.28JavaScript.2FActionScript.2C_etc..29\nexport default class TileConversion {\n  static lon2tile(lon, zoom, rounded = true) {\n    const tile = (lon + 180) / 360 * Math.pow(2, zoom);\n\n    return rounded\n      ? Math.floor(tile)\n      : tile;\n  }\n\n  static lat2tile(lat, zoom, rounded = true) {\n    const tile = (1 - Math.log(Math.tan(lat * Math.PI / 180) + 1 / Math.cos(lat * Math.PI / 180))\n      / Math.PI) / 2 * Math.pow(2, zoom);\n\n    return rounded\n      ? Math.floor(tile)\n      : tile;\n  }\n\n  static tile2lon(x, z) {\n    return x / Math.pow(2, z) * 360 - 180;\n  }\n\n  static tile2lat(y, z) {\n    const n = Math.PI - 2 * Math.PI * y / Math.pow(2, z);\n\n    return 180 / Math.PI * Math.atan(0.5 * (Math.exp(n) - Math.exp(-n)));\n  }\n\n  static tile2boundingBox(x, y, zoom) {\n    return {\n      ne: [\n        TileConversion.tile2lat(y, zoom),\n        TileConversion.tile2lon(x + 1, zoom)\n      ],\n\n      sw: [\n        TileConversion.tile2lat(y + 1, zoom),\n        TileConversion.tile2lon(x, zoom)\n      ]\n    };\n  }\n\n  static pixelToLatLon(pixel, center, zoom, tileSize) {\n    const pointDiff = [\n      pixel[0] / tileSize,\n      pixel[1] / tileSize\n    ];\n\n    const tileX = TileConversion.lon2tile(center[1], zoom, false) - pointDiff[0];\n    const tileY = TileConversion.lat2tile(center[0], zoom, false) - pointDiff[1];\n\n    return [\n      TileConversion.tile2lat(tileY, zoom),\n      TileConversion.tile2lon(tileX, zoom)\n    ];\n  }\n\n  static latLonToPixel(coord, center, zoom, tileSize) {\n    const tileX = TileConversion.lon2tile(coord[1], zoom, false);\n    const tileY = TileConversion.lat2tile(coord[0], zoom, false);\n\n    let tileCenterX = 0, tileCenterY = 0;\n\n    if (center) {\n      tileCenterX = TileConversion.lon2tile(center[1], zoom, false);\n      tileCenterY = TileConversion.lat2tile(center[0], zoom, false);\n    }\n\n    return [\n      -(tileX - tileCenterX) * tileSize,\n      -(tileY - tileCenterY) * tileSize\n    ];\n  }\n}\n","export default class Tile {\n  constructor(x, y, zoom) {\n    this._x = x;\n    this._y = y;\n    this._zoom = zoom;\n  }\n\n  get x() {\n    return this._x;\n  }\n\n  get y() {\n    return this._y;\n  }\n\n  get zoom() {\n    return this._zoom;\n  }\n\n  get id() {\n    return [this.x, this.y, this.zoom].join('|');\n  }\n\n  isValid() {\n    const max = (1 << this.zoom);\n\n    if (this.x >= max || this.x < 0 || this.y >= max || this.y < 0) {\n      return false;\n    }\n\n    return true;\n  }\n}\n","import TileConversion from './TileConversion';\nimport Tile from './Tile';\n\nexport default class TileLayer {\n\n  constructor(map, tilesZoomLevel = null) {\n    this.map = map;\n    this.tilesZoomLevel = tilesZoomLevel;\n    this.shouldBeDeleted = false;\n\n    this.context = map.context;\n\n    this.state = {\n      grid: [],\n      gridHash: null,\n      relativeTileOffset: [0, 0]\n    };\n  }\n\n  toJSON() {\n    return [\n      this.state,\n      this.loadedPercentage() // We want a change in loaded tiles to possibly trigger a redraw\n    ];\n  }\n\n  getTilesCount(canvasSize) {\n    let tilesCount = Math.ceil(canvasSize / this.map.options.tileSize) * this.map.options.tileAreaMultiplier;\n\n    if (tilesCount % 2 === 0) {\n      tilesCount++;\n    }\n\n    return tilesCount;\n  }\n\n  calculateGrid() {\n    const { state, options } = this.map;\n\n    const centerY = TileConversion.lat2tile(options.center[0], Math.round(this.tilesZoomLevel || options.zoom), false);\n    const centerX = TileConversion.lon2tile(options.center[1], Math.round(this.tilesZoomLevel || options.zoom), false);\n    const gridHash = [centerY, centerX].join(',');\n\n    const gridNeedsToBeUpdated = this.state.gridHash !== gridHash;\n\n    if (!gridNeedsToBeUpdated) {\n      return;\n    }\n\n    const horizontalTiles = this.getTilesCount(state.canvasDimensions[0]);\n    const verticalTiles = this.getTilesCount(state.canvasDimensions[1]);\n\n    // noinspection JSSuspiciousNameCombination\n    const centerYRounded = Math.floor(centerY);\n    const centerXRounded = Math.floor(centerX);\n\n    this.state.relativeTileOffset = [\n      Math.abs(centerX - centerXRounded),\n      Math.abs(centerY - centerYRounded)\n    ];\n\n    const startX = centerXRounded - Math.floor(horizontalTiles / 2);\n    const startY = centerYRounded - Math.floor(verticalTiles / 2);\n\n    let grid = [];\n\n    for (let y = 0; y < verticalTiles; y++) {\n      for (let x = 0; x < horizontalTiles; x++) {\n        if (!grid[x]) {\n          grid[x] = [];\n        }\n\n        const tileX = startX + x;\n        const tileY = startY + y;\n\n        const tile = new Tile(tileX, tileY, Math.round(this.tilesZoomLevel || options.zoom));\n\n        if (tile.isValid()) {\n          this.ensureTileAsset(tile);\n          grid[x][y] = tile;\n        }\n      }\n    }\n\n    this.state.grid = grid;\n    this.state.gridHash = gridHash;\n  }\n\n  ensureTileAsset(tile) {\n    if (!(tile.id in this.map.state.tiles)) {\n      const tileUrl = this.map.options.source(Math.floor(tile.x), Math.floor(tile.y), tile.zoom);\n\n      this.map.state.tiles[tile.id] = new Image();\n      this.map.state.tiles[tile.id].tileId = tile.id;\n      this.map.state.tiles[tile.id].src = tileUrl;\n      this.map.state.tiles[tile.id].loaded = false;\n      this.map.state.tiles[tile.id].onload = () => {\n        this.map.state.tiles[tile.id].loaded = true;\n      };\n    }\n\n    this.map.state.tiles[tile.id].lastRequested = new Date().getTime();\n  }\n\n  drawTiles(scale) {\n    const canvasWidth = this.map.state.canvasDimensions[0];\n    const canvasHeight = this.map.state.canvasDimensions[1];\n\n    const tileSize = this.map.options.tileSize * scale;\n\n    const centerOffset = [\n      tileSize / 2 - (this.state.relativeTileOffset[0] * tileSize),\n      tileSize / 2 - (this.state.relativeTileOffset[1] * tileSize)\n    ];\n\n    this.context.fillStyle = '#EEE';\n    this.context.fillRect(0, 0, canvasWidth, canvasHeight);\n\n    const horizontalTiles = this.getTilesCount(canvasWidth);\n    const verticalTiles = this.getTilesCount(canvasHeight);\n\n    const horizontalOverflow = (horizontalTiles * tileSize) - canvasWidth;\n    const verticalOverflow = (verticalTiles * tileSize) - canvasHeight;\n\n    for (let y = 0; y < verticalTiles; y++) {\n      for (let x = 0; x < horizontalTiles; x++) {\n        const tile = this.state.grid[x][y];\n\n        if (tile) {\n          const tileX = this.map.state.moveOffset[0] + centerOffset[0]\n            + (x * tileSize - horizontalOverflow / 2);\n\n          const tileY = this.map.state.moveOffset[1] + centerOffset[1]\n            + (y * tileSize - verticalOverflow / 2);\n\n          try {\n            if (this.map.state.tiles[tile.id].loaded) {\n              this.context.drawImage(this.map.state.tiles[tile.id], tileX, tileY, tileSize, tileSize);\n            } else {\n              this.drawGenericBackground(tileX, tileY, tileSize);\n            }\n          } catch (err) {\n            this.drawGenericBackground(tileX, tileY, tileSize);\n          }\n\n          if (this.map.options.debug) {\n            this.context.strokeStyle = 'green';\n            this.context.strokeRect(tileX, tileY, tileSize, tileSize);\n          }\n        }\n      }\n    }\n\n    if (this.map.options.debug) {\n      this.context.fillStyle = 'rgba(200, 0, 0, 0.7)';\n      this.context.beginPath();\n      this.context.arc(canvasWidth / 2, canvasHeight / 2, 5, 0, 2 * Math.PI);\n      this.context.fill();\n    }\n  }\n\n  drawGenericBackground(x, y, size) {\n    const increment = size / 8;\n\n    this.context.beginPath();\n    for (let lineX = increment; lineX < size; lineX += increment) {\n      for (let lineY = increment; lineY < size; lineY += increment) {\n        this.context.moveTo(x, y + lineY);\n        this.context.lineTo(x + size, y + lineY);\n\n        this.context.moveTo(x + lineX, y);\n        this.context.lineTo(x + lineX, y + size);\n      }\n    }\n    this.context.strokeStyle = '#DDD';\n    this.context.stroke();\n\n    this.context.strokeStyle = '#CCC';\n    this.context.strokeRect(x, y, size, size);\n  }\n\n  loadedPercentage() {\n    const horizontalTiles = this.getTilesCount(this.map.state.canvasDimensions[0]);\n    const verticalTiles = this.getTilesCount(this.map.state.canvasDimensions[1]);\n\n    let totalTiles = 0, loadedTiles = 0;\n\n    for (let y = 0; y < verticalTiles; y++) {\n      for (let x = 0; x < horizontalTiles; x++) {\n        const tile = this.state.grid[x][y];\n\n        if (tile) {\n          totalTiles++;\n        }\n\n        const cachedTile = tile && this.map.state.tiles[tile.id];\n\n        if (cachedTile && cachedTile.loaded) {\n          loadedTiles++;\n        }\n      }\n    }\n\n    return loadedTiles / totalTiles;\n  }\n}\n","export default class MapState {\n  constructor(center, zoom, targetZoom, tileSize, canvasDimensions, moveOffset) {\n    this._center = center;\n    this._zoom = zoom;\n    this._targetZoom = targetZoom;\n    this._tileSize = tileSize;\n    this._canvasDimensions = canvasDimensions;\n    this._moveOffset = moveOffset;\n  }\n\n  get center() {\n    return this._center;\n  }\n\n  get zoom() {\n    return this._zoom;\n  }\n\n  get targetZoom() {\n    return this._targetZoom;\n  }\n\n  get tileSize() {\n    return this._tileSize;\n  }\n\n  get canvasDimensions() {\n    return this._canvasDimensions;\n  }\n\n  get moveOffset() {\n    return this._moveOffset;\n  }\n}\n","export const defaultMapOptions = {\n  /**\n   * Common options\n   */\n  source: (x, y, z) => `https://maps.geocod.io/tiles/base/${z}/${x}/${y}.png`,\n  zoom: 12,\n  center: [38.841779, -77.088312],\n  attribution: '© OpenStreetMap contributors',\n\n  /**\n   * Width and height in pixels for each tile, you most likely do not want to change this.\n   */\n  tileSize: 256,\n\n  /**\n   * Determines the distance travelled when panning the map, the higher the value the further the\n   * distance\n   */\n  panAccelerationMultiplier: 2,\n\n  /**\n   * The maximum acceleration constant for when the map is thrown. This is in place to avoid\n   * super-sonic acceleration speeds :)\n   */\n  maxPanAcceleration: 3.5,\n\n  /**\n   * Only consider high velocity mouse movements that has been performed within this timing\n   * threshold (in milliseconds)\n   */\n  throwTimingThresholdMs: 100,\n\n  /**\n   * If the mouse panning velocity is above this threshold, it is considering a throw rather than\n   * a regular pan. We use this to pan further when the mouse is moved quickly\n   */\n  throwVelocityThreshold: 3000,\n\n  /**\n   * How quickly panning and zooming animations are executed (in milliseconds)\n   */\n  animationDurationMs: 300,\n\n  /*\n   * Used for debouncing events such as scrolling\n   * Note: Needs to be greater than the animationDurationMs value\n   */\n  debounceIntervalMs: 350,\n\n  /**\n   * Determines how many additional tiles that should be loaded, to decrease map load times when\n   * panning the map around\n\n   * Minimum value: 1.25\n   */\n  tileAreaMultiplier: 2,\n\n  /**\n   * When debug mode is enabled, additional rendering artifacts are drawn. Should only be used in\n   * conjuction with development of the library\n   */\n  debug: false\n};\n\nexport const defaultMarkerOptions = {\n  /**\n   * What color should the marker be?\n   * Supports hex, rgb and rgba values\n   */\n  color: 'rgba(0, 0, 200, 0.7)',\n\n  /**\n   * Valid values: marker, circle, donut, image\n   */\n  type: 'marker',\n\n  /**\n   * Image object for the rendered icon\n   * Note: Only used for markers with the \"image\" type\n   */\n  image: null,\n\n  /**\n   * Horizontal and vertical offset.\n   * When the offset is set to [0,0], the image is centered horizontally and vertically.\n   * You might for example want add a vertical offset to teardrop-shaped marker icons\n   * Note: Only used for markers with the \"image\" type\n   */\n  offset: [0, 0]\n};\n\nexport const defaultPolygonOptions = {\n  /**\n   * Whether the polygon should have a stroked line\n   */\n  enableStroke: true,\n\n  /**\n   * What color should the polygon lines be?\n   * Supports hex, rgb and rgba values\n   */\n  strokeStyle: 'rgba(50, 25, 50, 1.0)',\n\n  /**\n   * Specify distances to alternately draw a line and a gap to form\n   * a dashed or dotted line. Line will be solid if array is empty\n   */\n  lineDash: [],\n\n  /**\n   * Specify the thickness of polygon lines. The width scales with the zoom level, so the actual\n   * width in pixels is: lineWidth * zoom\n   */\n  lineWidth: 0.25,\n\n  /**\n   * Whether the polygon should be filled with a color\n   */\n  enableFill: true,\n\n  /**\n   * What color should the polygon be filled with?\n   * Supports hex, rgb and rgba values\n   */\n  fillStyle: 'rgba(0, 0, 0, 0.2)'\n};\n\nexport const defaultPolygonHoverOptions = {\n  strokeStyle: 'red',\n  lineWidth: 0.5\n};\n\n","import TileConversion from './TileConversion';\nimport TileLayer from './TileLayer';\nimport MapState from './MapState';\nimport { defaultMapOptions } from './defaultOptions';\n\nexport default class Map {\n\n  constructor(canvas, options) {\n    if (!canvas || !canvas.getContext) {\n      throw new Error('Could not get canvas context');\n    }\n\n    this.canvas = canvas;\n    this.context = this.canvas.getContext('2d');\n\n    this.options = Object.assign({}, defaultMapOptions, options);\n\n    this.initializeState();\n    this.attachEvents();\n\n    this.lastDrawState = null;\n\n    /**\n     * Events\n     */\n    this.onMarkerClicked = null;\n    this.onMarkerHover = null;\n    this.onPolygonClicked = null;\n    this.onPolygonHover = null;\n\n    this.draw = this.draw.bind(this);\n    window.requestAnimationFrame(this.draw);\n  }\n\n  initializeState() {\n    this.state = {\n      canvasDimensions: [this.canvas.width, this.canvas.height],\n      tiles: {},\n      moveOffset: [0, 0],\n      targetMoveOffset: [0, 0],\n      targetMoveOffsetIsCoord: false,\n      moveAnimationStart: null,\n      dragStartPosition: null,\n      lastZoomEventActionTime: null,\n      startZoom: this.options.zoom,\n      targetZoom: this.options.zoom,\n      zoomAnimationStart: null,\n      scale: 1,\n      lastMouseMoveEvent: null,\n      mouseVelocities: [],\n      markers: [],\n      polygons: [],\n      tileLayers: [\n        new TileLayer(this)\n      ],\n      mousePosition: { x: 0, y: 0},\n      forceRedraw: false\n    };\n  }\n\n  getZoom() {\n    return this.options.zoom;\n  }\n\n  setZoom(zoom) {\n    if (this.zoomValueIsValid(zoom) && this.isReadyForZoomEvent()) {\n      zoom = Math.round(zoom);\n\n      this.state.tileLayers.push(new TileLayer(this, zoom));\n      // this.state.tileLayers[0].tilesZoomLevel = this.options.zoom;\n\n      this.state.lastZoomEventActionTime = window.performance.now();\n      this.state.zoomAnimationStart = window.performance.now();\n      this.state.targetZoom = zoom;\n      this.state.startZoom = this.options.zoom;\n    }\n  }\n\n  setCenter(coord) {\n    if (!Array.isArray(coord) || coord.length !== 2) {\n      throw new Error('Please provide a valid array with a lat/lon');\n    }\n\n    coord = coord.map(coord => parseFloat(coord));\n\n    this.state.moveAnimationStart = window.performance.now();\n    this.state.targetMoveOffset = coord;\n    this.state.targetMoveOffsetIsCoord = true;\n  }\n\n  setTargetMoveOffset(x, y, animated = true) {\n    if (animated) {\n      this.state.moveAnimationStart = window.performance.now();\n\n      this.state.targetMoveOffset = TileConversion.pixelToLatLon(\n        [x, y],\n        this.options.center,\n        this.options.zoom,\n        this.options.tileSize\n      );\n\n      this.state.targetMoveOffsetIsCoord = true;\n    } else {\n      this.state.targetMoveOffset = [x, y];\n      this.state.targetMoveOffsetIsCoord = false;\n\n      this.state.moveOffset = this.state.targetMoveOffset;\n    }\n  }\n\n  zoomValueIsValid(zoom) {\n    return zoom >= 1 && zoom <= 18;\n  }\n\n  isReadyForZoomEvent() {\n    if (!this.state.lastZoomEventActionTime) {\n      return true;\n    }\n\n    const now = window.performance.now();\n    const milliSecondsSinceLastEvent = now - this.state.lastZoomEventActionTime;\n\n    return milliSecondsSinceLastEvent > this.options.debounceIntervalMs;\n  }\n\n  calculateVelocity(position1, position2, time1, time2) {\n    return ((position1 - position2) / (time1 - time2)) * 1000;\n  }\n\n  attachEvents() {\n    this.canvas.addEventListener('wheel', event => {\n      event.preventDefault();\n\n      if (event.deltaY > 5) {\n        this.setZoom(this.options.zoom - 1);\n      } else if (event.deltaY < -5) {\n        this.setZoom(this.options.zoom + 1);\n      }\n    });\n\n    this.canvas.addEventListener('dblclick', event => {\n      event.preventDefault();\n      this.updateMousePosition(event);\n\n      const canvasCenter = this.getCanvasCenter();\n\n      this.setTargetMoveOffset(\n        -(this.state.mousePosition.x - canvasCenter[0]),\n        -(this.state.mousePosition.y - canvasCenter[1])\n      );\n\n      this.setZoom(this.options.zoom + 1);\n    });\n\n    this.canvas.addEventListener('mousedown', event => {\n      event.preventDefault();\n      this.updateMousePosition(event);\n\n      if (!this.handleMouseEventInteraction(event, 'mousedown')) {\n        this.state.mouseVelocities = [];\n\n        this.state.dragStartPosition = [\n          this.state.mousePosition.x - this.state.moveOffset[0],\n          this.state.mousePosition.y - this.state.moveOffset[1]\n        ];\n      }\n    });\n\n    this.canvas.addEventListener('mouseup', event => {\n      event.preventDefault();\n      this.updateMousePosition(event);\n\n      if (!this.state.dragStartPosition) {\n        this.handleMouseEventInteraction(event, 'mouseup');\n      } else {\n        const x = -(this.state.dragStartPosition[0] - this.state.mousePosition.x);\n        const y = -(this.state.dragStartPosition[1] - this.state.mousePosition.y);\n\n        this.state.dragStartPosition = null;\n\n        const dragDistanceBelowThreshold = Math.abs(x) <= 5 && Math.abs(y) <= 5;\n\n        if (dragDistanceBelowThreshold) {\n          this.handleMouseEventInteraction(event, 'mouseup');\n        } else {\n          if (this.state.moveOffset[0] !== 0 || this.state.moveOffset[1] !== 0) {\n            const now = window.performance.now();\n            const timingThreshold = now - this.options.throwTimingThresholdMs;\n\n            const thresholdsToConsider = this.state.mouseVelocities\n              .filter(threshold => threshold[0] > timingThreshold)\n              .map(threshold => threshold[1]);\n\n            const velocitySum = thresholdsToConsider.reduce(\n              (accumulator, velocity) => accumulator + velocity,\n              0\n            );\n\n            const averageVelocity = velocitySum / thresholdsToConsider.length;\n\n            if (averageVelocity >= this.options.throwVelocityThreshold) {\n              let multiplier = averageVelocity / this.options.throwVelocityThreshold\n                * this.options.panAccelerationMultiplier;\n\n              multiplier = Math.min(multiplier, this.options.maxPanAcceleration);\n\n              this.setTargetMoveOffset(\n                x * multiplier,\n                y * multiplier\n              );\n            } else {\n              this.updateCenter();\n            }\n          }\n        }\n      }\n    });\n\n    this.canvas.addEventListener('mousemove', event => {\n      event.preventDefault();\n      this.updateMousePosition(event);\n\n      if (this.state.dragStartPosition) {\n        const x = -(this.state.dragStartPosition[0] - this.state.mousePosition.x);\n        const y = -(this.state.dragStartPosition[1] - this.state.mousePosition.y);\n\n        const now = window.performance.now();\n\n        const vx = this.calculateVelocity(this.state.moveOffset[0], x, now, this.state.lastMouseMoveEvent);\n        const vy = this.calculateVelocity(this.state.moveOffset[1], y, now, this.state.lastMouseMoveEvent);\n\n        const velocity = Math.round(Math.sqrt((vx * vx) + (vy * vy)));\n\n        this.state.mouseVelocities.push([now, velocity]);\n\n        this.setTargetMoveOffset(x, y, false);\n        this.state.lastMouseMoveEvent = window.performance.now();\n      } else {\n        this.handleMouseEventInteraction(event, 'mousemove');\n      }\n\n      return false;\n    });\n  }\n\n  isCurrentlyDraggingMap() {\n    return this.state.dragStartPosition !== null;\n  }\n\n  enablePolygonInteractivity() {\n    return this.onPolygonHover || this.onPolygonClicked;\n  }\n\n  updateMousePosition(event) {\n    const rect = this.canvas.getBoundingClientRect();\n\n    this.state.mousePosition = {\n      x: event.clientX - rect.left,\n      y: event.clientY - rect.top\n    };\n  }\n\n  easeOutQuad(time) {\n    return time * (2 - time);\n  }\n\n  updateMoveOffset() {\n    const targetMoveOffsetChanged = this.state.moveOffset !== this.state.targetMoveOffset;\n\n    if (targetMoveOffsetChanged) {\n      const timestamp = window.performance.now();\n\n      const progress = Math.max(timestamp - this.state.moveAnimationStart, 0);\n      const percentage = this.easeOutQuad(progress / this.options.animationDurationMs);\n\n      let targetMoveOffset = this.state.targetMoveOffset;\n\n      if (this.state.targetMoveOffsetIsCoord) {\n        targetMoveOffset = TileConversion.latLonToPixel(\n          this.state.targetMoveOffset,\n          this.options.center,\n          this.options.zoom,\n          this.options.tileSize\n        );\n      }\n\n      if (percentage >= 0.99) {\n        this.state.moveOffset = targetMoveOffset;\n      } else {\n        this.state.moveOffset = [\n          this.state.moveOffset[0] + (targetMoveOffset[0] - this.state.moveOffset[0]) * percentage,\n          this.state.moveOffset[1] + (targetMoveOffset[1] - this.state.moveOffset[1]) * percentage\n        ];\n      }\n\n      const targetHasBeenReached = this.state.moveOffset === targetMoveOffset;\n\n      if (targetHasBeenReached) {\n        this.updateCenter();\n      }\n    }\n  }\n\n  updateCenter() {\n    const latLon = TileConversion.pixelToLatLon(\n      this.state.moveOffset,\n      this.options.center,\n      this.options.zoom,\n      this.options.tileSize\n    );\n\n    this.setTargetMoveOffset(0, 0, false);\n    this.options.center = latLon;\n  }\n\n  updateZoom() {\n    if (this.options.zoom !== this.state.targetZoom) {\n      const progress = Math.max(window.performance.now() - this.state.zoomAnimationStart, 0);\n      const percentage = this.easeOutQuad(progress / this.options.animationDurationMs);\n\n      let differenceFromTarget = Math.abs(this.state.targetZoom - this.state.startZoom);\n\n      if (this.state.targetZoom <= this.state.startZoom) {\n        differenceFromTarget *= -1;\n      }\n\n      const newZoomDiff = differenceFromTarget * percentage;\n      const remainingTime = this.options.animationDurationMs - progress;\n\n      this.options.zoom = remainingTime <= 5\n        ? this.state.targetZoom\n        : (this.state.startZoom + newZoomDiff);\n\n      const roundedZoom = Math.round(this.options.zoom);\n      const diff = this.options.zoom - roundedZoom;\n\n      this.state.scale = Math.pow(2, diff);\n\n      if (this.options.zoom === this.state.targetZoom) {\n        // Mark old tile layer for deletion\n        this.state.tileLayers.shift();\n        this.state.tileLayers[0].tilesZoomLevel = null;\n\n        // this.state.tileLayers[this.state.tileLayers.length - 1].shouldBeDeleted = true;\n      }\n    } else {\n      this.state.scale = 1;\n    }\n  }\n\n  garbageCollect() {\n    const allTiles = Object.values(this.state.tiles);\n\n    if (allTiles.length > this.maxTilesToKeep()) {\n      const tileExpirationCutOff = new Date().getTime() - 5000;\n\n      const tilesToConsider = allTiles\n        .filter(tile => tile.lastRequested < tileExpirationCutOff)\n        .sort((a, b) => ~~(a.lastRequested < b.lastRequested));\n\n      const tilesToDeleteCount = this.maxTilesToKeep() - (allTiles.length - tilesToConsider.length);\n\n      tilesToConsider\n        .splice(tilesToConsider.length - tilesToDeleteCount)\n        .forEach(tile => {\n          tile.src = '';\n          delete this.state.tiles[tile.tileId];\n        });\n    }\n  }\n\n  maxTilesToKeep() {\n    return 1000;\n  }\n\n  shouldRedraw() {\n    if (this.state.forceRedraw) {\n      this.state.forceRedraw = false;\n\n      return true;\n    }\n\n    const drawState = JSON.stringify([this.state, this.options]);\n\n    if (this.lastDrawState !== drawState) {\n      this.lastDrawState = drawState;\n\n      return true;\n    }\n\n    return false;\n  }\n\n  draw() {\n    this.updateMoveOffset();\n    this.updateZoom();\n    this.state.tileLayers.forEach(tileLayer => tileLayer.calculateGrid());\n    this.garbageCollect();\n\n    if (this.shouldRedraw()) {\n      // Delete tile layers that are ready for deletion and mostly loaded\n      /*\n      this.state.tileLayers = this.state.tileLayers\n        .filter(tileLayer => !(tileLayer.shouldBeDeleted && tileLayer.loadedPercentage() >= 0.9));\n\n      console.log(this.state.tileLayers.length);\n      */\n\n      if (this.state.tileLayers.length > 0) {\n        // Only draw the top layer\n        this.state.tileLayers[0].drawTiles(this.state.scale);\n      }\n\n      this.renderPolygons();\n      this.renderMarkers();\n      this.renderControls();\n      this.renderAttribution();\n    }\n\n    window.requestAnimationFrame(this.draw);\n  }\n\n  getMapBounds() {\n    const canvasCenter = this.getCanvasCenter();\n\n    const nw = TileConversion.pixelToLatLon(\n      [canvasCenter[0], canvasCenter[1]],\n      this.options.center,\n      this.options.zoom,\n      this.options.tileSize\n    );\n\n    const se = TileConversion.pixelToLatLon(\n      [-canvasCenter[0], -canvasCenter[1]],\n      this.options.center,\n      this.options.zoom,\n      this.options.tileSize\n    );\n\n    return {\n      nw, se\n    };\n  }\n\n  getVisibleMarkers() {\n    const bounds = this.getMapBounds();\n\n    return this.state.markers.filter(marker => {\n      return marker.coords[0] <= bounds.nw[0] && marker.coords[0] >= bounds.se[0]\n        && marker.coords[1] >= bounds.nw[1] && marker.coords[1] <= bounds.se[1];\n    });\n  }\n\n  getCanvasCenter() {\n    return [\n      this.state.canvasDimensions[0] / 2,\n      this.state.canvasDimensions[1] / 2\n    ];\n  }\n\n  renderMarkers() {\n    const visibleMarkers = this.getVisibleMarkers();\n    const canvasCenter = this.getCanvasCenter();\n\n    visibleMarkers.map(marker => {\n      const position = TileConversion.latLonToPixel(\n        marker.coords,\n        this.options.center,\n        this.options.zoom,\n        this.options.tileSize\n      );\n\n      marker.render(this.context, [\n        canvasCenter[0] - position[0] + this.state.moveOffset[0],\n        canvasCenter[1] - position[1] + this.state.moveOffset[1]\n      ]);\n    });\n  }\n\n  renderPolygons() {\n    const mapState = new MapState(\n      this.options.center,\n      this.options.zoom,\n      this.state.targetZoom,\n      this.options.tileSize,\n      this.state.canvasDimensions,\n      this.state.moveOffset\n    );\n\n    this.state.polygons.map(polygon => {\n      polygon.render(this.context, mapState);\n\n      if (this.enablePolygonInteractivity() && !this.isCurrentlyDraggingMap()) {\n        polygon.handleMouseOver(this.context, mapState, this.state.mousePosition);\n      }\n    });\n  }\n\n  handleMouseEventInteraction(event, name) {\n    const controlObjects = this.getControlObjects().filter(item => this.isMouseOverObject(item.bounds));\n\n    const markers = controlObjects.length <= 0 && (this.onMarkerClicked || this.onMarkerHover)\n      ? this.getMarkersBounds().filter(item => this.isMouseOverObject(item.bounds))\n      : [];\n\n    if (name === 'mouseup') {\n      if (controlObjects.length > 0) {\n        const controlObject = controlObjects[0];\n\n        this.setZoom(controlObject.label === '+'\n          ? this.options.zoom + 1\n          : this.options.zoom - 1);\n      }\n\n      if (this.onMarkerClicked) {\n        markers.map(item => this.onMarkerClicked(item.marker));\n      }\n    } else {\n      if (this.onMarkerHover) {\n        markers.map(item => this.onMarkerHover(item.marker));\n      }\n    }\n\n    let controlsOrMarkersIsHover = controlObjects.length > 0 || markers.length > 0;\n\n    let polygonIsHover = false;\n\n    if (this.enablePolygonInteractivity() && !this.isCurrentlyDraggingMap() && !controlsOrMarkersIsHover) {\n      let polygons = [];\n\n      const mapState = new MapState(\n        this.options.center,\n        this.options.zoom,\n        this.state.targetZoom,\n        this.options.tileSize,\n        this.state.canvasDimensions,\n        this.state.moveOffset\n      );\n\n      polygons = this.state.polygons.map(polygon =>\n        polygon.handleMouseOver(null, mapState, this.state.mousePosition)\n      ).filter(polygon => polygon.length > 0);\n\n      polygonIsHover = polygons.length > 0;\n\n      if (polygonIsHover) {\n        const eventHandler = (name === 'mouseup')\n          ? this.onPolygonClicked\n          : this.onPolygonHover;\n\n        if (eventHandler) {\n          polygons.map(polygon => polygon.map(item => eventHandler(item)));\n        }\n      }\n    }\n\n    this.canvas.style.cursor = controlsOrMarkersIsHover || polygonIsHover\n      ? 'pointer'\n      : 'grab';\n\n    // Let caller know if controls or markers were interacted with. This will prevent further\n    // mouse interactions from being triggered\n    return controlsOrMarkersIsHover;\n  }\n\n  getControlObjects() {\n    const margin = 4;\n    const size = 30;\n\n    return [\n      {\n        bounds: {\n          x: margin,\n          y: margin,\n          width: size,\n          height: size\n        },\n        label: '+'\n      },\n      {\n        bounds: {\n          x: margin,\n          y: margin + size + margin,\n          width: size,\n          height: size\n        },\n        label: '-'\n      }\n    ];\n  }\n\n  getMarkersBounds() {\n    const visibleMarkers = this.getVisibleMarkers();\n    const canvasCenter = this.getCanvasCenter();\n\n    return visibleMarkers.map(marker => {\n      const position = TileConversion.latLonToPixel(\n        marker.coords,\n        this.options.center,\n        this.options.zoom,\n        this.options.tileSize\n      );\n\n      const markerSize = marker.size;\n      const markerOffset = marker.offset;\n\n      return {\n        bounds: {\n          x: canvasCenter[0] - position[0] + this.state.moveOffset[0] - (markerSize[0] / 2) + markerOffset[0],\n          y: canvasCenter[1] - position[1] + this.state.moveOffset[1] - (markerSize[1] / 2) + markerOffset[1],\n          width: markerSize[0],\n          height: markerSize[1]\n        },\n        marker\n      };\n    });\n  }\n\n  renderControls() {\n    this.getControlObjects().map(item => this.renderControl(item.bounds, item.label));\n  }\n\n  renderControl(bounds, label) {\n    const radius = 10;\n\n    // Background\n    this.context.fillStyle = this.isMouseOverObject(bounds)\n      ? 'rgba(100, 100, 100, 0.7)'\n      : 'rgba(0, 0, 0, 0.7)';\n\n    this.roundedRectangle(bounds.x, bounds.y, bounds.width, bounds.height, radius);\n\n    // Text\n    this.context.font = 'bold 25px courier';\n    this.context.textAlign = 'center';\n    this.context.textBaseline = 'middle';\n    this.context.fillStyle = 'rgba(255, 255, 255)';\n\n    this.context.fillText(\n      label,\n      bounds.x + (bounds.width / 2),\n      bounds.y + (bounds.height / 2)\n    );\n  }\n\n  isMouseOverObject(bounds) {\n    return this.state.mousePosition.x >= bounds.x\n      && this.state.mousePosition.x <= bounds.x + bounds.width\n      && this.state.mousePosition.y >= bounds.y\n      && this.state.mousePosition.y <= bounds.y + bounds.height;\n  }\n\n  renderAttribution() {\n    const margin = 4;\n\n    this.context.font = 'bold 12px sans-serif';\n    this.context.textAlign = 'left';\n    this.context.textBaseline = 'alphabetic';\n\n    const textBounds = this.context.measureText(this.options.attribution);\n\n    const x = this.state.canvasDimensions[0] - textBounds.width - margin;\n    const y = this.state.canvasDimensions[1] - 2 - margin;\n\n    this.context.fillStyle = 'rgba(255, 255, 255, 0.7)';\n    this.roundedRectangle(x - margin, y - 15, textBounds.width + 80, 80);\n\n    this.context.fillStyle = 'rgba(0, 0, 0, 0.7)';\n    this.context.fillText(this.options.attribution, x, y);\n  }\n\n  roundedRectangle(x, y, width, height, radius = 5) {\n    this.context.beginPath();\n    this.context.moveTo(x + radius, y);\n    this.context.lineTo(x + width - radius, y);\n    this.context.quadraticCurveTo(x + width, y, x + width, y + radius);\n    this.context.lineTo(x + width, y + height - radius);\n    this.context.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\n    this.context.lineTo(x + radius, y + height);\n    this.context.quadraticCurveTo(x, y + height, x, y + height - radius);\n    this.context.lineTo(x, y + radius);\n    this.context.quadraticCurveTo(x, y, x + radius, y);\n    this.context.closePath();\n\n    this.context.fill();\n  }\n\n  addMarker(marker) {\n    this.state.markers.push(marker);\n  }\n\n  addMarkers(markers) {\n    markers.map(marker => this.addMarker(marker));\n  }\n\n  setMarkers(markers) {\n    this.state.markers = markers;\n    this.state.forceRedraw = true;\n  }\n\n  addPolygon(polygon) {\n    this.state.polygons.push(polygon);\n  }\n\n  setPolygons(polygons) {\n    this.state.polygons = polygons;\n  }\n\n}\n","import { defaultMarkerOptions } from './defaultOptions';\n\nexport default class Marker {\n  constructor(coords, options = {}) {\n    this._coords = coords;\n    this._options = Object.assign({}, defaultMarkerOptions, options);\n  }\n\n  get coords() {\n    return this._coords;\n  }\n\n  get options() {\n    return this._options;\n  }\n\n  get size() {\n    switch (this.options.type) {\n      case 'marker':\n        return [\n          17.698069,\n          24.786272\n        ];\n\n      case 'circle':\n        return [10, 10];\n\n      case 'donut':\n        return [14, 14];\n\n      case 'image':\n        return this.options.image\n          ? [this.options.image.width, this.options.image.height]\n          : null;\n\n      default:\n        return null;\n    }\n  }\n\n  get offset() {\n    switch (this.options.type) {\n      case 'marker':\n        return [\n          0,\n          -(this.size[1] / 2)\n        ];\n\n      case 'image':\n        return this.options.offset;\n\n      default:\n        return [0, 0];\n    }\n  }\n\n  render(context, position) {\n    let renderFunction = null;\n\n    switch (this.options.type) {\n      case 'marker':\n        renderFunction = this.renderMarker;\n        break;\n\n      case 'circle':\n        renderFunction = this.renderCircle;\n        break;\n\n      case 'donut':\n        renderFunction = this.renderDonut;\n        break;\n\n      case 'image':\n        renderFunction = this.renderImage;\n        break;\n    }\n\n    if (!renderFunction) {\n      throw new Error(`Unsupported marker type: \"${this.options.type}\"`);\n    } else {\n      context.fillStyle = this.options.color;\n      context.strokeStyle = this.options.color;\n\n      renderFunction = renderFunction.bind(this);\n      renderFunction(context, position);\n    }\n  }\n\n  renderCircle(context, position) {\n    context.save();\n    context.beginPath();\n    context.arc(position[0], position[1], this.size[0] / 2, 0, 2 * Math.PI);\n    context.fill();\n    context.restore();\n  }\n\n  renderDonut(context, position) {\n    context.save();\n    context.beginPath();\n    context.lineWidth = 5;\n    context.arc(position[0], position[1], this.size[0] / 2, 0, 2 * Math.PI);\n    context.stroke();\n    context.restore();\n  }\n\n  renderMarker(context, position) {\n    const size = this.size;\n\n    const x = position[0] - size[0] / 2;\n    const y = position[1] - size[1];\n\n    context.save();\n    context.transform(0.184386, 0.000000, 0.000000, 0.184386, 0.551658 + x, 4.095760 + y);\n    context.beginPath();\n    context.lineWidth = 1.667195;\n    context.moveTo(45.000000, -22.212949);\n    context.bezierCurveTo(18.494941, -22.212949, -2.991863, -0.726145, -2.991863, 25.778914);\n    context.bezierCurveTo(-2.991863, 52.282306, 45.000000, 112.212950, 45.000000, 112.212950);\n    context.bezierCurveTo(45.000000, 112.212950, 92.991863, 52.282306, 92.991863, 25.777247);\n    context.bezierCurveTo(92.991863, -0.726145, 71.505059, -22.212949, 45.000000, -22.212949);\n    context.moveTo(45.000000, 43.827962);\n    context.bezierCurveTo(33.553042, 43.827962, 24.273437, 34.550024, 24.273437, 23.103067);\n    context.bezierCurveTo(24.273437, 11.656109, 33.553042, 2.376504, 45.000000, 2.376504);\n    context.bezierCurveTo(56.446958, 2.376504, 65.726563, 11.654442, 65.726563, 23.101399);\n    context.bezierCurveTo(65.726563, 34.548357, 56.446958, 43.827962, 45.000000, 43.827962);\n    context.fill();\n    context.restore();\n  }\n\n  renderImage(context, position) {\n    if (this.options.image) {\n      const size = this.size;\n      const x = position[0] - size[0] / 2 + this.offset[0];\n      const y = position[1] - size[1] / 2 + this.offset[1];\n\n      context.drawImage(this.options.image, x, y, size[0], size[1]);\n    }\n  }\n}\n","export default function(x) {\n  return x;\n}\n","import identity from \"./identity\";\n\nexport default function(transform) {\n  if (transform == null) return identity;\n  var x0,\n      y0,\n      kx = transform.scale[0],\n      ky = transform.scale[1],\n      dx = transform.translate[0],\n      dy = transform.translate[1];\n  return function(input, i) {\n    if (!i) x0 = y0 = 0;\n    var j = 2, n = input.length, output = new Array(n);\n    output[0] = (x0 += input[0]) * kx + dx;\n    output[1] = (y0 += input[1]) * ky + dy;\n    while (j < n) output[j] = input[j], ++j;\n    return output;\n  };\n}\n","export default function(array, n) {\n  var t, j = array.length, i = j - n;\n  while (i < --j) t = array[i], array[i++] = array[j], array[j] = t;\n}\n","import reverse from \"./reverse\";\nimport transform from \"./transform\";\n\nexport default function(topology, o) {\n  return o.type === \"GeometryCollection\"\n      ? {type: \"FeatureCollection\", features: o.geometries.map(function(o) { return feature(topology, o); })}\n      : feature(topology, o);\n}\n\nexport function feature(topology, o) {\n  var id = o.id,\n      bbox = o.bbox,\n      properties = o.properties == null ? {} : o.properties,\n      geometry = object(topology, o);\n  return id == null && bbox == null ? {type: \"Feature\", properties: properties, geometry: geometry}\n      : bbox == null ? {type: \"Feature\", id: id, properties: properties, geometry: geometry}\n      : {type: \"Feature\", id: id, bbox: bbox, properties: properties, geometry: geometry};\n}\n\nexport function object(topology, o) {\n  var transformPoint = transform(topology.transform),\n      arcs = topology.arcs;\n\n  function arc(i, points) {\n    if (points.length) points.pop();\n    for (var a = arcs[i < 0 ? ~i : i], k = 0, n = a.length; k < n; ++k) {\n      points.push(transformPoint(a[k], k));\n    }\n    if (i < 0) reverse(points, n);\n  }\n\n  function point(p) {\n    return transformPoint(p);\n  }\n\n  function line(arcs) {\n    var points = [];\n    for (var i = 0, n = arcs.length; i < n; ++i) arc(arcs[i], points);\n    if (points.length < 2) points.push(points[0]); // This should never happen per the specification.\n    return points;\n  }\n\n  function ring(arcs) {\n    var points = line(arcs);\n    while (points.length < 4) points.push(points[0]); // This may happen if an arc has only two points.\n    return points;\n  }\n\n  function polygon(arcs) {\n    return arcs.map(ring);\n  }\n\n  function geometry(o) {\n    var type = o.type, coordinates;\n    switch (type) {\n      case \"GeometryCollection\": return {type: type, geometries: o.geometries.map(geometry)};\n      case \"Point\": coordinates = point(o.coordinates); break;\n      case \"MultiPoint\": coordinates = o.coordinates.map(point); break;\n      case \"LineString\": coordinates = line(o.arcs); break;\n      case \"MultiLineString\": coordinates = o.arcs.map(line); break;\n      case \"Polygon\": coordinates = polygon(o.arcs); break;\n      case \"MultiPolygon\": coordinates = o.arcs.map(polygon); break;\n      default: return null;\n    }\n    return {type: type, coordinates: coordinates};\n  }\n\n  return geometry(o);\n}\n","export default function(a, x) {\n  var lo = 0, hi = a.length;\n  while (lo < hi) {\n    var mid = lo + hi >>> 1;\n    if (a[mid] < x) lo = mid + 1;\n    else hi = mid;\n  }\n  return lo;\n}\n","import { defaultPolygonOptions, defaultPolygonHoverOptions } from './defaultOptions';\nimport TileConversion from './TileConversion';\nimport { feature } from 'topojson-client';\nimport classifyPoint from 'robust-point-in-polygon';\n\nexport default class Polygon {\n  constructor(json, objectName, options = {}, hoverOptions = null) {\n    this._options = Object.assign({}, defaultPolygonOptions, options);\n    this._hoverOptions = Object.assign({}, defaultPolygonOptions, defaultPolygonHoverOptions, hoverOptions);\n    this.globalIndex = this.prepareGlobalDataObject();\n\n    if (!objectName) {\n      objectName = Object.keys(json.objects)[0];\n    }\n\n    if (!(objectName in json.objects)) {\n      throw new Error(`Invalid object name, valid options are: ${Object.keys(json.objects).join(', ')}`);\n    }\n\n    this.geometry = feature(json, json.objects[objectName]);\n  }\n\n  get options() {\n    return this._options;\n  }\n\n  get hoverOptions() {\n    return this._hoverOptions;\n  }\n\n  get geometry() {\n    return window.lightningMapsPolygons[this.globalIndex].geometry;\n  }\n\n  set geometry(geometry) {\n    window.lightningMapsPolygons[this.globalIndex].geometry = geometry;\n  }\n\n  get projectedGeometry() {\n    return window.lightningMapsPolygons[this.globalIndex].projectedGeometry;\n  }\n\n  set projectedGeometry(projectedGeometry) {\n    window.lightningMapsPolygons[this.globalIndex].projectedGeometry = projectedGeometry;\n  }\n\n  prepareGlobalDataObject() {\n    if (!('lightningMapsPolygons' in window)) {\n      window.lightningMapsPolygons = [];\n    }\n\n    const index = window.lightningMapsPolygons.length;\n\n    window.lightningMapsPolygons[index] = {\n      geometry: null,\n      projectedGeometry: null\n    };\n\n    return index;\n  }\n\n  handleMouseOver(context, mapState, mousePosition) {\n    const currentlyZooming = Math.round(mapState.zoom) !== mapState.zoom;\n\n    if (!this.geometry || !this.projectedGeometry || currentlyZooming) {\n      return [];\n    }\n\n    const canvasCenter = [\n      mapState.canvasDimensions[0] / 2,\n      mapState.canvasDimensions[1] / 2\n    ];\n\n    const originZoom = this.determineOriginZoom(mapState);\n    const centerOffset = this.calculateCenterOffset(mapState, originZoom);\n    const point = [\n      mousePosition.x - centerOffset[0] - canvasCenter[0],\n      mousePosition.y - centerOffset[1] - canvasCenter[1]\n    ];\n\n    return this.projectedGeometry.filter(item => {\n      const isHover = item.geometry.filter(list => classifyPoint(list, point) === -1).length > 0;\n\n      if (isHover && context) {\n        context.beginPath();\n\n        item.geometry.map((list) => {\n          list.map((position, index) => {\n            position = [\n              position[0] + centerOffset[0] + canvasCenter[0],\n              position[1] + centerOffset[1] + canvasCenter[1]\n            ];\n\n            if (index === 0) {\n              context.moveTo(position[0], position[1]);\n            } else {\n              context.lineTo(position[0], position[1]);\n            }\n          });\n        });\n\n        this.applyContextStyles(context, this.hoverOptions, mapState.zoom);\n\n        if (this.options.enableStroke) context.fill();\n        if (this.options.enableFill) context.stroke();\n      }\n\n      return isHover;\n    });\n  }\n\n  calculateCenterOffset(mapState, originZoom) {\n    return [\n      -(TileConversion.lon2tile(mapState.center[1], originZoom, false) * mapState.tileSize),\n      -(TileConversion.lat2tile(mapState.center[0], originZoom, false) * mapState.tileSize)\n    ];\n  }\n\n  render(context, mapState) {\n    if (!this.geometry) {\n      return;\n    }\n\n    const originZoom = this.determineOriginZoom(mapState);\n\n    const zoomDiff = originZoom\n      ? mapState.zoom - originZoom\n      : 0;\n\n    const scale = zoomDiff !== 0\n      ? Math.pow(2, zoomDiff)\n      : 1;\n\n    const mapCenterChanged = this.renderedMapCenter !== mapState.center,\n      mapZoomChanged = (zoomDiff === 0 && this.renderedZoomLevel !== mapState.zoom);\n\n    const shouldReRender = mapCenterChanged || mapZoomChanged;\n\n    let centerOffset = null;\n\n    if (shouldReRender) {\n      this.renderedZoomLevel = mapState.zoom;\n      this.renderedMapCenter = mapState.center;\n\n      this.projectedGeometry = this.geometry.features.map(feature => {\n        return {\n          ...feature,\n          geometry: this.projectGeometry(feature.geometry, mapState)\n        };\n      });\n\n      centerOffset = this.calculateCenterOffset(mapState, originZoom);\n\n      this.calculatePolygonExtends(centerOffset);\n    }\n\n    const canvasCenter = [\n      mapState.canvasDimensions[0] / 2,\n      mapState.canvasDimensions[1] / 2\n    ];\n\n    const imagePosition = [\n      canvasCenter[0] + mapState.moveOffset[0] + (this.polygonExtends.minX * scale),\n      canvasCenter[1] + mapState.moveOffset[1] + (this.polygonExtends.minY * scale)\n    ];\n\n    const imageRect = {\n      left: Math.floor(imagePosition[0] * -1),\n      right: Math.ceil(Math.abs(imagePosition[0]) + mapState.canvasDimensions[0]),\n      top: Math.floor(imagePosition[1] * -1),\n      bottom: Math.ceil(Math.abs(imagePosition[1]) + mapState.canvasDimensions[1])\n    };\n\n    if (shouldReRender) {\n      this.renderOffscreenCanvas(mapState, centerOffset, imageRect);\n    }\n\n    const imageDrawPosition = [\n      mapState.moveOffset[0] - (canvasCenter[0] * (scale - 1)),\n      mapState.moveOffset[1] - (canvasCenter[1] * (scale - 1))\n    ];\n\n    const scaledWidth = this.polygonDimensions[0] * scale,\n      scaledHeight = this.polygonDimensions[1] * scale;\n\n    context.drawImage(\n      this.offscreenCanvas,\n      imageDrawPosition[0], imageDrawPosition[1],\n      scaledWidth, scaledHeight\n    );\n  }\n\n  determineOriginZoom(mapState) {\n    let originZoom = mapState.zoom;\n\n    if (mapState.targetZoom > mapState.zoom) { // Zoming in\n      originZoom = Math.floor(mapState.zoom);\n    } else if (mapState.targetZoom < mapState.zoom) { // Zooming out\n      originZoom = Math.ceil(mapState.zoom);\n    }\n\n    return originZoom;\n  }\n\n  createOffscreenCanvas(clipRect) {\n    this.polygonDimensions = [\n      clipRect.right - clipRect.left,\n      clipRect.bottom - clipRect.top\n    ];\n\n    this.offscreenCanvas = document.createElement('canvas');\n    this.offscreenCanvas.width = this.polygonDimensions[0];\n    this.offscreenCanvas.height = this.polygonDimensions[1];\n\n    return this.offscreenCanvas.getContext('2d');\n  }\n\n  calculatePolygonExtends(centerOffset) {\n    let minX, maxX, minY, maxY = null;\n\n    this.mapGeometry(position => {\n      position = [\n        position[0] + centerOffset[0],\n        position[1] + centerOffset[1]\n      ];\n\n      if (!maxX || position[0] > maxX) {\n        maxX = position[0];\n      }\n\n      if (!minX || position[0] < minX) {\n        minX = position[0];\n      }\n\n      if (!maxY || position[1] > maxY) {\n        maxY = position[1];\n      }\n\n      if (!minY || position[1] < minY) {\n        minY = position[1];\n      }\n    });\n\n    this.polygonDimensions = [\n      Math.ceil(maxX - minX),\n      Math.ceil(maxY - minY)\n    ];\n\n    this.polygonExtends = {\n      minX, maxX,\n      minY, maxY\n    };\n  }\n\n  renderOffscreenCanvas(mapState, centerOffset, clipRect) {\n    const offscreenContext = this.createOffscreenCanvas(clipRect);\n\n    offscreenContext.beginPath();\n    offscreenContext.font = 'bold 8px helvetica';\n\n    this.projectedGeometry.map((item) =>\n      item.geometry.map((list) => {\n        const pointsInClipRect = list.filter(position => {\n          position = [\n            position[0] - this.polygonExtends.minX + centerOffset[0],\n            position[1] - this.polygonExtends.minY + centerOffset[1]\n          ];\n\n          return position[0] >= clipRect.left && position[0] <= clipRect.right\n           && position[1] >= clipRect.top && position[1] <= clipRect.bottom;\n        });\n\n        if (pointsInClipRect.length > 0) {\n          list.map((position, index) => {\n            position = [\n              position[0] - this.polygonExtends.minX + centerOffset[0] - clipRect.left,\n              position[1] - this.polygonExtends.minY + centerOffset[1] - clipRect.top\n            ];\n\n            if (index === 0) {\n              // offscreenContext.fillText(item.properties.NAME, position[0], position[1]);\n\n              offscreenContext.moveTo(position[0], position[1]);\n            } else {\n              offscreenContext.lineTo(position[0], position[1]);\n            }\n          });\n        }\n      })\n    );\n\n    this.applyContextStyles(offscreenContext, this.options, mapState.zoom);\n\n    if (this.options.enableStroke) offscreenContext.fill();\n    if (this.options.enableFill) offscreenContext.stroke();\n  }\n\n  applyContextStyles(context, options, zoom) {\n    context.fillStyle = options.fillStyle;\n    context.strokeStyle = options.strokeStyle;\n    context.lineWidth = options.lineWidth * zoom;\n    context.setLineDash(options.lineDash);\n    context.lineJoin = 'round';\n  }\n\n  mapGeometry(pointCallback) {\n    return this.projectedGeometry.map((item) =>\n      item.geometry.map((list) =>\n        list.map(pointCallback)\n      )\n    );\n  }\n\n  projectGeometry(geometry, mapState) {\n    if (geometry) {\n      switch (geometry.type) {\n        case 'Polygon':\n          return [geometry.coordinates[0].map(item => this.projectPoint(mapState, item[0], item[1]))];\n\n        case 'MultiPolygon':\n          return geometry.coordinates.map(coordinates =>\n            coordinates[0].map(item => this.projectPoint(mapState, item[0], item[1]))\n          );\n      }\n    }\n\n    return [];\n  }\n\n  projectPoint(mapState, x, y) {\n    const position = TileConversion.latLonToPixel(\n      [y, x],\n      null,\n      mapState.zoom,\n      mapState.tileSize\n    );\n\n    return [-position[0], -position[1]];\n  }\n}\n","import Map from './Map';\nimport Marker from './Marker';\nimport Polygon from './Polygon';\n\nexport {\n  Map,\n  Marker,\n  Polygon\n};\n"],"sourceRoot":""}